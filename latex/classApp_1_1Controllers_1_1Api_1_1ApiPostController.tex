\doxysection{Referencia de la clase App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}Api\+Post\+Controller}
\hypertarget{classApp_1_1Controllers_1_1Api_1_1ApiPostController}{}\label{classApp_1_1Controllers_1_1Api_1_1ApiPostController}\index{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}}


Controlador para manejar solicitudes POST a la API.  




Diagrama de colaboración de App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}Api\+Post\+Controller\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=221pt]{classApp_1_1Controllers_1_1Api_1_1ApiPostController__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Métodos públicos}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a2bcdd18cfddc818675fea20ac107b048}{\+\_\+\+\_\+construct}} (\$pdo)
\begin{DoxyCompactList}\small\item\em Constructor del controlador. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1Api_1_1ApiPostController_aead3d9c7c87cd02937893d1ddd880ce8}{add\+Favorite}} (\$user\+Id, \$fungi\+Id)
\begin{DoxyCompactList}\small\item\em Maneja el proceso de agregar hongos a favoritos. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1Api_1_1ApiPostController_ade6aee7846792084e491b5d0cc52c1f5}{handle\+Login}} (\$data, \$login\+Callback, \$generate\+Token\+Callback)
\begin{DoxyCompactList}\small\item\em Maneja el proceso de autenticación. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a0db625d8d0d36e9e8cf766ea91832017}{handle\+Logout}} ()
\begin{DoxyCompactList}\small\item\em Maneja el proceso de cierre de sesión. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a113d04fa6ae129cff1ef322e4f200c68}{like\+Fungi}} (\$user\+Id, \$fungi\+Id)
\begin{DoxyCompactList}\small\item\em Maneja el proceso de likes a hongos. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a9cbc4be80f4ad92465bb69d4c1152555}{register\+User}} (\$data)
\begin{DoxyCompactList}\small\item\em Maneja el registro de un nuevo usuario. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Métodos privados}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a803ac21c48d07c1218e801d9e8aed1ee}{validate\+Required\+Fields}} (array \$data, array \$required\+Fields)
\begin{DoxyCompactList}\small\item\em Validación de campos requeridos. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Atributos privados}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1Api_1_1ApiPostController_afa5d3aebcc534d215a31266d491553b3}{\$db}}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1Api_1_1ApiPostController_ac4e4df2c4136c12c53fa8f06bb1d8904}{\$pdo}}
\end{DoxyCompactItemize}


\doxysubsection{Descripción detallada}
Controlador para manejar solicitudes POST a la API. 

Esta clase proporciona métodos para procesar diferentes tipos de solicitudes POST a la API, como creación de usuarios, autenticación, likes y favoritos. 

Definición en la línea \mbox{\hyperlink{ApiPostController_8php_source_l00016}{16}} del archivo \mbox{\hyperlink{ApiPostController_8php_source}{Api\+Post\+Controller.\+php}}.



\doxysubsection{Documentación de constructores y destructores}
\Hypertarget{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a2bcdd18cfddc818675fea20ac107b048}\label{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a2bcdd18cfddc818675fea20ac107b048} 
\index{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}!\_\_construct@{\_\_construct}}
\index{\_\_construct@{\_\_construct}!App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}}
\doxysubsubsection{\texorpdfstring{\_\_construct()}{\_\_construct()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\+::\+\_\+\+\_\+construct (\begin{DoxyParamCaption}\item[{}]{\$pdo }\end{DoxyParamCaption})}



Constructor del controlador. 


\begin{DoxyParams}[1]{Parámetros}
\textbackslash{}\+PDO & {\em \$pdo} & Conexión PDO a la base de datos \\
\hline
\end{DoxyParams}


Definición en la línea \mbox{\hyperlink{ApiPostController_8php_source_l00026}{26}} del archivo \mbox{\hyperlink{ApiPostController_8php_source}{Api\+Post\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00027\ \ \ \ \ \{}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \$this-\/>pdo\ =\ \mbox{\hyperlink{classApp_1_1Controllers_1_1Api_1_1ApiPostController_ac4e4df2c4136c12c53fa8f06bb1d8904}{\$pdo}};}
\DoxyCodeLine{00029\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{ApiPostController_8php_source_l00018}{App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\textbackslash{}\$pdo}}.



\doxysubsection{Documentación de funciones miembro}
\Hypertarget{classApp_1_1Controllers_1_1Api_1_1ApiPostController_aead3d9c7c87cd02937893d1ddd880ce8}\label{classApp_1_1Controllers_1_1Api_1_1ApiPostController_aead3d9c7c87cd02937893d1ddd880ce8} 
\index{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}!addFavorite@{addFavorite}}
\index{addFavorite@{addFavorite}!App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}}
\doxysubsubsection{\texorpdfstring{addFavorite()}{addFavorite()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\+::add\+Favorite (\begin{DoxyParamCaption}\item[{}]{\$user\+Id,  }\item[{}]{\$fungi\+Id }\end{DoxyParamCaption})}



Maneja el proceso de agregar hongos a favoritos. 


\begin{DoxyParams}[1]{Parámetros}
int & {\em \$user\+Id} & ID del usuario \\
\hline
int & {\em \$fungi\+Id} & ID del hongo \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array Respuesta con resultado de la operación 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{ApiPostController_8php_source_l00128}{128}} del archivo \mbox{\hyperlink{ApiPostController_8php_source}{Api\+Post\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00129\ \ \ \ \ \{}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \$stmt\ =\ \$this-\/>pdo-\/>prepare(\textcolor{stringliteral}{"{}INSERT\ INTO\ user\_favorites\ (user\_id,\ fungi\_id)\ VALUES\ (?,\ ?)"{}});}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \$result\ =\ \$stmt-\/>execute([\$userId,\ \$fungiId]);}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$result)\ \{}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{true},}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'message'}\ =>\ \textcolor{stringliteral}{'Hongo\ añadido\ a\ favoritos'}}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ http\_response\_code(500);}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ ErrorMessages::DB\_QUERY\_ERROR}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00145\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classApp_1_1Controllers_1_1Api_1_1ApiPostController_ade6aee7846792084e491b5d0cc52c1f5}\label{classApp_1_1Controllers_1_1Api_1_1ApiPostController_ade6aee7846792084e491b5d0cc52c1f5} 
\index{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}!handleLogin@{handleLogin}}
\index{handleLogin@{handleLogin}!App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}}
\doxysubsubsection{\texorpdfstring{handleLogin()}{handleLogin()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\+::handle\+Login (\begin{DoxyParamCaption}\item[{}]{\$data,  }\item[{}]{\$login\+Callback,  }\item[{}]{\$generate\+Token\+Callback }\end{DoxyParamCaption})}



Maneja el proceso de autenticación. 


\begin{DoxyParams}[1]{Parámetros}
array & {\em \$data} & Credenciales del usuario \\
\hline
callable & {\em \$login\+Callback} & Función para autenticar \\
\hline
callable & {\em \$generate\+Token\+Callback} & Función para generar token \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array Respuesta con token y datos del usuario 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{ApiPostController_8php_source_l00155}{155}} del archivo \mbox{\hyperlink{ApiPostController_8php_source}{Api\+Post\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00156\ \ \ \ \ \{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \$requiredFields\ =\ [\textcolor{stringliteral}{'username'},\ \textcolor{stringliteral}{'password'}];}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a803ac21c48d07c1218e801d9e8aed1ee}{validateRequiredFields}}(\$data,\ \$requiredFields))\ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \ \ http\_response\_code(400);}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},\ }
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ ErrorMessages::format(ErrorMessages::VALIDATION\_REQUIRED\_FIELD,\ \textcolor{stringliteral}{'username,\ password'})}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Autenticar\ usuario\ usando\ el\ callback}}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \$user\ =\ \$loginCallback(\$data[\textcolor{stringliteral}{'username'}],\ \$data[\textcolor{stringliteral}{'password'}]);}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$user)\ \{}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Generar\ token\ JWT\ usando\ el\ callback}}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \$token\ =\ \$generateTokenCallback(\$user);}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{true},\ }
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'token'}\ =>\ \$token,}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'user'}\ =>\ [}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'id'}\ =>\ \$user[\textcolor{stringliteral}{'id'}],}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'username'}\ =>\ \$user[\textcolor{stringliteral}{'username'}],}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'email'}\ =>\ \$user[\textcolor{stringliteral}{'email'}],}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'role'}\ =>\ \$user[\textcolor{stringliteral}{'role'}]}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ http\_response\_code(401);}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},\ }
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ ErrorMessages::AUTH\_INVALID\_CREDENTIALS}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00190\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{ApiPostController_8php_source_l00229}{App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\textbackslash{}validate\+Required\+Fields()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1Api_1_1ApiPostController_ade6aee7846792084e491b5d0cc52c1f5_cgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a0db625d8d0d36e9e8cf766ea91832017}\label{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a0db625d8d0d36e9e8cf766ea91832017} 
\index{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}!handleLogout@{handleLogout}}
\index{handleLogout@{handleLogout}!App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}}
\doxysubsubsection{\texorpdfstring{handleLogout()}{handleLogout()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\+::handle\+Logout (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Maneja el proceso de cierre de sesión. 

\begin{DoxyReturn}{Devuelve}
array Respuesta con resultado de la operación 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{ApiPostController_8php_source_l00197}{197}} del archivo \mbox{\hyperlink{ApiPostController_8php_source}{Api\+Post\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00198\ \ \ \ \ \{}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (session\_status()\ ===\ PHP\_SESSION\_NONE)\ \{}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ session\_start();}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Limpiar\ sesión}}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \$\_SESSION\ =\ array();}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Eliminar\ cookies}}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isset(\$\_COOKIE[session\_name()]))\ \{}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ setcookie(session\_name(),\ \textcolor{stringliteral}{''},\ time()\ -\/\ 42000,\ \textcolor{charliteral}{'/'});}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ setcookie(\textcolor{stringliteral}{'token'},\ \textcolor{stringliteral}{''},\ time()\ -\/\ 42000,\ \textcolor{charliteral}{'/'});}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ setcookie(\textcolor{stringliteral}{'jwt'},\ \textcolor{stringliteral}{''},\ time()\ -\/\ 42000,\ \textcolor{charliteral}{'/'});}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Destruir\ sesión}}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ session\_destroy();}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{true},}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'message'}\ =>\ \textcolor{stringliteral}{'Sesión\ cerrada\ correctamente'}}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00220\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a113d04fa6ae129cff1ef322e4f200c68}\label{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a113d04fa6ae129cff1ef322e4f200c68} 
\index{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}!likeFungi@{likeFungi}}
\index{likeFungi@{likeFungi}!App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}}
\doxysubsubsection{\texorpdfstring{likeFungi()}{likeFungi()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\+::like\+Fungi (\begin{DoxyParamCaption}\item[{}]{\$user\+Id,  }\item[{}]{\$fungi\+Id }\end{DoxyParamCaption})}



Maneja el proceso de likes a hongos. 


\begin{DoxyParams}[1]{Parámetros}
int & {\em \$user\+Id} & ID del usuario \\
\hline
int & {\em \$fungi\+Id} & ID del hongo \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array Respuesta con resultado de la operación 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{ApiPostController_8php_source_l00102}{102}} del archivo \mbox{\hyperlink{ApiPostController_8php_source}{Api\+Post\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00103\ \ \ \ \ \{}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{routes_8php_a0bbc1d7715d0f934d799d5556a9216bf}{\$fungiController}}\ =\ new\ \(\backslash\)App\(\backslash\)Controllers\(\backslash\)FungiController(\$this-\/>db);}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \$result\ =\ \mbox{\hyperlink{routes_8php_a0bbc1d7715d0f934d799d5556a9216bf}{\$fungiController}}-\/>likeFungi(\$userId,\ \$fungiId);}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$result)\ \{}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{true},}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'message'}\ =>\ \textcolor{stringliteral}{'Hongo\ marcado\ como\ "{}me\ gusta"{}'}}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ http\_response\_code(500);}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ ErrorMessages::DB\_QUERY\_ERROR}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00119\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{routes_8php_source_l00097}{\$fungi\+Controller}}.

\Hypertarget{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a9cbc4be80f4ad92465bb69d4c1152555}\label{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a9cbc4be80f4ad92465bb69d4c1152555} 
\index{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}!registerUser@{registerUser}}
\index{registerUser@{registerUser}!App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}}
\doxysubsubsection{\texorpdfstring{registerUser()}{registerUser()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\+::register\+User (\begin{DoxyParamCaption}\item[{}]{\$data }\end{DoxyParamCaption})}



Maneja el registro de un nuevo usuario. 


\begin{DoxyParams}[1]{Parámetros}
array & {\em \$data} & Datos del usuario a registrar \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array Respuesta con resultado del registro 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{ApiPostController_8php_source_l00037}{37}} del archivo \mbox{\hyperlink{ApiPostController_8php_source}{Api\+Post\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00038\ \ \ \ \ \{}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \$requiredFields\ =\ [\textcolor{stringliteral}{'username'},\ \textcolor{stringliteral}{'email'},\ \textcolor{stringliteral}{'password'}];}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a803ac21c48d07c1218e801d9e8aed1ee}{validateRequiredFields}}(\$data,\ \$requiredFields))\ \{}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ http\_response\_code(400);}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ ErrorMessages::format(ErrorMessages::VALIDATION\_REQUIRED\_FIELD,\ \textcolor{stringliteral}{'username,\ email,\ password'})}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Validación\ de\ formato\ de\ email}}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!filter\_var(\$data[\textcolor{stringliteral}{'email'}],\ FILTER\_VALIDATE\_EMAIL))\ \{}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ http\_response\_code(400);}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ ErrorMessages::VALIDATION\_INVALID\_EMAIL}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Verificar\ que\ el\ nombre\ de\ usuario\ no\ exista}}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \$stmt\ =\ \$this-\/>pdo-\/>prepare(\textcolor{stringliteral}{"{}SELECT\ id\ FROM\ users\ WHERE\ username\ =\ ?"{}});}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \$stmt-\/>execute([\$data[\textcolor{stringliteral}{'username'}]]);}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$stmt-\/>fetch())\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ http\_response\_code(409);}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ ErrorMessages::format(ErrorMessages::VALIDATION\_VALUE\_ALREADY\_EXISTS,\ \textcolor{stringliteral}{'username'})}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Verificar\ que\ el\ email\ no\ exista}}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \$stmt\ =\ \$this-\/>pdo-\/>prepare(\textcolor{stringliteral}{"{}SELECT\ id\ FROM\ users\ WHERE\ email\ =\ ?"{}});}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \$stmt-\/>execute([\$data[\textcolor{stringliteral}{'email'}]]);}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$stmt-\/>fetch())\ \{}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ http\_response\_code(409);}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ ErrorMessages::format(ErrorMessages::VALIDATION\_VALUE\_ALREADY\_EXISTS,\ \textcolor{stringliteral}{'email'})}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Generar\ hash\ de\ la\ contraseña}}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \$passwordHash\ =\ password\_hash(\$data[\textcolor{stringliteral}{'password'}],\ PASSWORD\_BCRYPT);}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Insertar\ el\ nuevo\ usuario}}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \$stmt\ =\ \$this-\/>pdo-\/>prepare(\textcolor{stringliteral}{"{}INSERT\ INTO\ users\ (username,\ email,\ password\_hash,\ role,\ created\_at)\ VALUES\ (?,\ ?,\ ?,\ 'user',\ NOW())"{}});}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \$stmt-\/>execute([\$data[\textcolor{stringliteral}{'username'}],\ \$data[\textcolor{stringliteral}{'email'}],\ \$passwordHash]);}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \$userId\ =\ \$this-\/>pdo-\/>lastInsertId();}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{true},}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'id'}\ =>\ \$userId,}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'message'}\ =>\ \textcolor{stringliteral}{'Usuario\ registrado\ exitosamente'}}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00093\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{ApiPostController_8php_source_l00229}{App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\textbackslash{}validate\+Required\+Fields()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a9cbc4be80f4ad92465bb69d4c1152555_cgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a803ac21c48d07c1218e801d9e8aed1ee}\label{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a803ac21c48d07c1218e801d9e8aed1ee} 
\index{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}!validateRequiredFields@{validateRequiredFields}}
\index{validateRequiredFields@{validateRequiredFields}!App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}}
\doxysubsubsection{\texorpdfstring{validateRequiredFields()}{validateRequiredFields()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\+::validate\+Required\+Fields (\begin{DoxyParamCaption}\item[{array}]{\$data,  }\item[{array}]{\$required\+Fields }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Validación de campos requeridos. 


\begin{DoxyParams}[1]{Parámetros}
array & {\em \$data} & Los datos a validar \\
\hline
array & {\em \$required\+Fields} & Lista de campos requeridos \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
bool Verdadero si todos los campos requeridos están presentes 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{ApiPostController_8php_source_l00229}{229}} del archivo \mbox{\hyperlink{ApiPostController_8php_source}{Api\+Post\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \textcolor{keywordtype}{bool}}
\DoxyCodeLine{00230\ \ \ \ \ \{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\$requiredFields\ as\ \$field)\ \{}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!isset(\$data[\$field])\ ||\ empty(\$data[\$field]))\ \{}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00237\ \ \ \ \ \}}

\end{DoxyCode}


Referenciado por \mbox{\hyperlink{ApiPostController_8php_source_l00155}{App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\textbackslash{}handle\+Login()}} y \mbox{\hyperlink{ApiPostController_8php_source_l00037}{App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\textbackslash{}register\+User()}}.

Gráfico de llamadas a esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1Api_1_1ApiPostController_a803ac21c48d07c1218e801d9e8aed1ee_icgraph}
\end{center}
\end{figure}


\doxysubsection{Documentación de datos miembro}
\Hypertarget{classApp_1_1Controllers_1_1Api_1_1ApiPostController_afa5d3aebcc534d215a31266d491553b3}\label{classApp_1_1Controllers_1_1Api_1_1ApiPostController_afa5d3aebcc534d215a31266d491553b3} 
\index{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}!\$db@{\$db}}
\index{\$db@{\$db}!App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}}
\doxysubsubsection{\texorpdfstring{\$db}{\$db}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\+::\$db\hspace{0.3cm}{\ttfamily [private]}}



Definición en la línea \mbox{\hyperlink{ApiPostController_8php_source_l00019}{19}} del archivo \mbox{\hyperlink{ApiPostController_8php_source}{Api\+Post\+Controller.\+php}}.

\Hypertarget{classApp_1_1Controllers_1_1Api_1_1ApiPostController_ac4e4df2c4136c12c53fa8f06bb1d8904}\label{classApp_1_1Controllers_1_1Api_1_1ApiPostController_ac4e4df2c4136c12c53fa8f06bb1d8904} 
\index{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}!\$pdo@{\$pdo}}
\index{\$pdo@{\$pdo}!App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController@{App\textbackslash{}Controllers\textbackslash{}Api\textbackslash{}ApiPostController}}
\doxysubsubsection{\texorpdfstring{\$pdo}{\$pdo}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\+::\$pdo\hspace{0.3cm}{\ttfamily [private]}}



Definición en la línea \mbox{\hyperlink{ApiPostController_8php_source_l00018}{18}} del archivo \mbox{\hyperlink{ApiPostController_8php_source}{Api\+Post\+Controller.\+php}}.



Referenciado por \mbox{\hyperlink{ApiPostController_8php_source_l00026}{App\textbackslash{}\+Controllers\textbackslash{}\+Api\textbackslash{}\+Api\+Post\+Controller\textbackslash{}\+\_\+\+\_\+construct()}}.



La documentación de esta clase está generada del siguiente archivo\+:\begin{DoxyCompactItemize}
\item 
src/controllers/\+Api/\mbox{\hyperlink{ApiPostController_8php}{Api\+Post\+Controller.\+php}}\end{DoxyCompactItemize}
