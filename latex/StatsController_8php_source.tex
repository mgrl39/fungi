\doxysection{Stats\+Controller.\+php}
\hypertarget{StatsController_8php_source}{}\label{StatsController_8php_source}\index{src/controllers/StatsController.php@{src/controllers/StatsController.php}}
\mbox{\hyperlink{StatsController_8php}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00001}00001\ <?php}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00003}00003\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceApp_1_1Controllers}{App\(\backslash\)Controllers}};}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00005}00005\ require\_once\ \_\_DIR\_\_\ .\ \textcolor{stringliteral}{'/../../vendor/autoload.php'};}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00014}\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController}{00014}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController}{StatsController}}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00015}00015\ \{}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00019}\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_acd274f9dac4bd8fb0b90261c3d971abd}{00019}}\ \ \ \ \ \textcolor{keyword}{private}\ \mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_acd274f9dac4bd8fb0b90261c3d971abd}{\$db}};}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00026}\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_aa29167da3f341e9199c640b102e5fc97}{00026}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_aa29167da3f341e9199c640b102e5fc97}{\_\_construct}}(\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_acd274f9dac4bd8fb0b90261c3d971abd}{\$db}})}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00027}00027\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00028}00028\ \ \ \ \ \ \ \ \ \$this-\/>db\ =\ \mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_acd274f9dac4bd8fb0b90261c3d971abd}{\$db}};}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00029}00029\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00037}\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a944a68a075295dfdc85e7e403b469358}{00037}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a944a68a075295dfdc85e7e403b469358}{getFungiStats}}(\$timeRange\ =\ \textcolor{stringliteral}{'all'})}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00038}00038\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00039}00039\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'edibility'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_af64065be7583a66e68d38bfade5585bb}{getEdibilityStats}}(\$timeRange),}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'families'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a9e0cdd48bfd132bccade19031dca3c25}{getFamilyStats}}(\$timeRange),}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'popular'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a9e81a77bff8dcf7481dbc58a4265ebe8}{getPopularFungi}}(\$timeRange),}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'divisions'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a42b7befe748ebafdfaf9a1e1669b6a4a}{getDivisionStats}}(\$timeRange),}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'classes'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a19103b3b40588b307b330f1b37e408d8}{getClassStats}}(\$timeRange),}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'orders'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a2ff7db3ac8f173dbccfbbb9d61b9412f}{getOrderStats}}(\$timeRange),}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00046}00046\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'userActivity'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a35b229bcab9985c40a2c2b2a26d8b774}{getUserActivityStats}}(\$timeRange)}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00047}00047\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00048}00048\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00056}\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_acbcc9cd24df7ea83bb72e818e3cf4ebe}{00056}}\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_acbcc9cd24df7ea83bb72e818e3cf4ebe}{getTimeRangeCondition}}(\$timeRange)}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00057}00057\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00058}00058\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (\$timeRange)\ \{}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{'week'}:}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}WHERE\ created\_at\ >=\ DATE\_SUB(NOW(),\ INTERVAL\ 1\ WEEK)"{}};}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{'month'}:}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}WHERE\ created\_at\ >=\ DATE\_SUB(NOW(),\ INTERVAL\ 1\ MONTH)"{}};}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{'year'}:}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}WHERE\ created\_at\ >=\ DATE\_SUB(NOW(),\ INTERVAL\ 1\ YEAR)"{}};}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00067}00067\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00068}00068\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00076}\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_af64065be7583a66e68d38bfade5585bb}{00076}}\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_af64065be7583a66e68d38bfade5585bb}{getEdibilityStats}}(\$timeRange)}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00077}00077\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00078}00078\ \ \ \ \ \ \ \ \ \$timeCondition\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_acbcc9cd24df7ea83bb72e818e3cf4ebe}{getTimeRangeCondition}}(\$timeRange);}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00079}00079\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>db-\/>query(}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SELECT\ edibility,\ COUNT(*)\ as\ count\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00081}00081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ FROM\ fungi\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00082}00082\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \$timeCondition}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00083}00083\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ GROUP\ BY\ edibility\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ ORDER\ BY\ count\ DESC"{}},}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ []}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00086}00086\ \ \ \ \ \ \ \ \ )-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00087}00087\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00088}00088\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00095}\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a9e0cdd48bfd132bccade19031dca3c25}{00095}}\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a9e0cdd48bfd132bccade19031dca3c25}{getFamilyStats}}(\$timeRange)}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00096}00096\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00097}00097\ \ \ \ \ \ \ \ \ \$timeCondition\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_acbcc9cd24df7ea83bb72e818e3cf4ebe}{getTimeRangeCondition}}(\$timeRange);}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00098}00098\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>db-\/>query(}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SELECT\ t.family,\ COUNT(*)\ as\ count\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00100}00100\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ FROM\ taxonomy\ t}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00101}00101\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ JOIN\ fungi\ f\ ON\ f.id\ =\ t.fungi\_id}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00102}00102\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \$timeCondition}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00103}00103\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ WHERE\ t.family\ IS\ NOT\ NULL\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00104}00104\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ GROUP\ BY\ t.family\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00105}00105\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ ORDER\ BY\ count\ DESC\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00106}00106\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ LIMIT\ 10"{}},}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00107}00107\ \ \ \ \ \ \ \ \ \ \ \ \ []}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00108}00108\ \ \ \ \ \ \ \ \ )-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00109}00109\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00110}00110\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00117}\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a9e81a77bff8dcf7481dbc58a4265ebe8}{00117}}\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a9e81a77bff8dcf7481dbc58a4265ebe8}{getPopularFungi}}(\$timeRange)}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00118}00118\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00119}00119\ \ \ \ \ \ \ \ \ \$timeCondition\ =\ str\_replace(\textcolor{stringliteral}{'created\_at'},\ \textcolor{stringliteral}{'fp.last\_view'},\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_acbcc9cd24df7ea83bb72e818e3cf4ebe}{getTimeRangeCondition}}(\$timeRange));}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00120}00120\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>db-\/>query(}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00121}00121\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SELECT\ f.name,\ fp.views\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00122}00122\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ FROM\ fungi\ f\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00123}00123\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ JOIN\ fungi\_popularity\ fp\ ON\ f.id\ =\ fp.fungi\_id\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00124}00124\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \$timeCondition}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00125}00125\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ ORDER\ BY\ fp.views\ DESC\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00126}00126\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ LIMIT\ 10"{}},}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ []}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00128}00128\ \ \ \ \ \ \ \ \ )-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00129}00129\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00130}00130\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00137}\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a42b7befe748ebafdfaf9a1e1669b6a4a}{00137}}\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a42b7befe748ebafdfaf9a1e1669b6a4a}{getDivisionStats}}(\$timeRange)}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00138}00138\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00139}00139\ \ \ \ \ \ \ \ \ \$timeCondition\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_acbcc9cd24df7ea83bb72e818e3cf4ebe}{getTimeRangeCondition}}(\$timeRange);}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00140}00140\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>db-\/>query(}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00141}00141\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SELECT\ division,\ COUNT(*)\ as\ count\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00142}00142\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ FROM\ taxonomy\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00143}00143\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ WHERE\ division\ IS\ NOT\ NULL\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00144}00144\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ GROUP\ BY\ division\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00145}00145\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ ORDER\ BY\ count\ DESC"{}},}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ []}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00147}00147\ \ \ \ \ \ \ \ \ )-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00148}00148\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00149}00149\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00156}\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a19103b3b40588b307b330f1b37e408d8}{00156}}\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a19103b3b40588b307b330f1b37e408d8}{getClassStats}}(\$timeRange)\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00157}00157\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00158}00158\ \ \ \ \ \ \ \ \ \$timeCondition\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_acbcc9cd24df7ea83bb72e818e3cf4ebe}{getTimeRangeCondition}}(\$timeRange);}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00159}00159\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>db-\/>query(}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00160}00160\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SELECT\ class,\ COUNT(*)\ as\ count\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00161}00161\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ FROM\ taxonomy\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00162}00162\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ WHERE\ class\ IS\ NOT\ NULL\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00163}00163\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ GROUP\ BY\ class\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00164}00164\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ ORDER\ BY\ count\ DESC\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00165}00165\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ LIMIT\ 10"{}},}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ []}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00167}00167\ \ \ \ \ \ \ \ \ )-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00168}00168\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00176}\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a2ff7db3ac8f173dbccfbbb9d61b9412f}{00176}}\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a2ff7db3ac8f173dbccfbbb9d61b9412f}{getOrderStats}}(\$timeRange)}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00177}00177\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00178}00178\ \ \ \ \ \ \ \ \ \$timeCondition\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_acbcc9cd24df7ea83bb72e818e3cf4ebe}{getTimeRangeCondition}}(\$timeRange);}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00179}00179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>db-\/>query(}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00180}00180\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SELECT\ ordo,\ COUNT(*)\ as\ count\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00181}00181\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ FROM\ taxonomy\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00182}00182\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ WHERE\ ordo\ IS\ NOT\ NULL\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00183}00183\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ GROUP\ BY\ ordo\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00184}00184\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ ORDER\ BY\ count\ DESC\ }}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00185}00185\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ LIMIT\ 10"{}},}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00186}00186\ \ \ \ \ \ \ \ \ \ \ \ \ []}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00187}00187\ \ \ \ \ \ \ \ \ )-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00188}00188\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00189}00189\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00196}\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a35b229bcab9985c40a2c2b2a26d8b774}{00196}}\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{function}\ \mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a35b229bcab9985c40a2c2b2a26d8b774}{getUserActivityStats}}(\$timeRange)}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00197}00197\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00198}00198\ \ \ \ \ \ \ \ \ \$interval\ =\ match(\$timeRange)\ \{}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00199}00199\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'week'}\ =>\ \textcolor{stringliteral}{'7\ DAY'},}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00200}00200\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'month'}\ =>\ \textcolor{stringliteral}{'30\ DAY'},}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00201}00201\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'year'}\ =>\ \textcolor{stringliteral}{'365\ DAY'},}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00202}00202\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}\ =>\ \textcolor{stringliteral}{'30\ DAY'}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00203}00203\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00204}00204\ }
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00205}00205\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>db-\/>query(}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00206}00206\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SELECT\ action,\ COUNT(*)\ as\ count,}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00207}00207\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ DATE\_FORMAT(access\_time,\ '\%Y-\/\%m-\/\%d')\ as\ date}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00208}00208\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ FROM\ access\_logs}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00209}00209\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ WHERE\ access\_time\ >=\ DATE\_SUB(NOW(),\ INTERVAL\ \$interval)}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00210}00210\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ GROUP\ BY\ action,\ date}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00211}00211\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ ORDER\ BY\ date\ ASC"{}},}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00212}00212\ \ \ \ \ \ \ \ \ \ \ \ \ []}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00213}00213\ \ \ \ \ \ \ \ \ )-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00214}00214\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{StatsController_8php_source_l00215}00215\ \}\ }

\end{DoxyCode}
