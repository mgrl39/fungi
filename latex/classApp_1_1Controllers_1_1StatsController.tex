\doxysection{Referencia de la clase App\textbackslash{}Controllers\textbackslash{}Stats\+Controller}
\hypertarget{classApp_1_1Controllers_1_1StatsController}{}\label{classApp_1_1Controllers_1_1StatsController}\index{App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}}


Controlador para generar estadísticas de hongos.  




Diagrama de colaboración de App\textbackslash{}Controllers\textbackslash{}Stats\+Controller\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=241pt]{classApp_1_1Controllers_1_1StatsController__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Métodos públicos}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_aa29167da3f341e9199c640b102e5fc97}{\+\_\+\+\_\+construct}} (\$db)
\begin{DoxyCompactList}\small\item\em Constructor del controlador de estadísticas. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_af2a1c7f7fb5c2ec3ddc6a82c7c9b5944}{get\+All\+Stats\+For\+Page}} ()
\begin{DoxyCompactList}\small\item\em Obtiene todas las estadísticas necesarias para la página de estadísticas. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_ac11f08ebb9f334bedbba480533be6e07}{get\+Family\+Distribution}} (\$limit=10)
\begin{DoxyCompactList}\small\item\em Obtiene la distribución de hongos por familia. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a33d5205f64fa0acd29b3416a6b5b5308}{get\+Top\+Favorites}} (\$limit=5)
\begin{DoxyCompactList}\small\item\em Obtiene los hongos más añadidos a favoritos. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_ac15d7095c544e0023e61febc70e6e690}{get\+Top\+Liked}} (\$limit=5)
\begin{DoxyCompactList}\small\item\em Obtiene los hongos más likeados. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a13a0ac992567acd018968d78f7a2201c}{statistics\+Page\+Handler}} (\$twig, \$db, \$session)
\begin{DoxyCompactList}\small\item\em Manejador de la página de estadísticas. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Métodos privados}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a54135d721d270bd3dec13083d4051dc6}{get\+Base\+Url}} ()
\begin{DoxyCompactList}\small\item\em Obtiene la URL base del sitio. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Atributos privados}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_acd274f9dac4bd8fb0b90261c3d971abd}{\$db}}
\end{DoxyCompactItemize}


\doxysubsection{Descripción detallada}
Controlador para generar estadísticas de hongos. 

Esta clase proporciona métodos para recuperar diferentes tipos de estadísticas relacionadas con los hongos en la base de datos. 

Definición en la línea \mbox{\hyperlink{StatsController_8php_source_l00012}{12}} del archivo \mbox{\hyperlink{StatsController_8php_source}{Stats\+Controller.\+php}}.



\doxysubsection{Documentación de constructores y destructores}
\Hypertarget{classApp_1_1Controllers_1_1StatsController_aa29167da3f341e9199c640b102e5fc97}\label{classApp_1_1Controllers_1_1StatsController_aa29167da3f341e9199c640b102e5fc97} 
\index{App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}!\_\_construct@{\_\_construct}}
\index{\_\_construct@{\_\_construct}!App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}}
\doxysubsubsection{\texorpdfstring{\_\_construct()}{\_\_construct()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\+::\+\_\+\+\_\+construct (\begin{DoxyParamCaption}\item[{}]{\$db }\end{DoxyParamCaption})}



Constructor del controlador de estadísticas. 


\begin{DoxyParams}[1]{Parámetros}
\textbackslash{}\+App\textbackslash{}\+Controllers\textbackslash{}\+Database\+Controller & {\em \$db} & Instancia de la conexión a la base de datos \\
\hline
\end{DoxyParams}


Definición en la línea \mbox{\hyperlink{StatsController_8php_source_l00024}{24}} del archivo \mbox{\hyperlink{StatsController_8php_source}{Stats\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00025\ \ \ \ \ \{}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \$this-\/>db\ =\ \mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_acd274f9dac4bd8fb0b90261c3d971abd}{\$db}};}
\DoxyCodeLine{00027\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{StatsController_8php_source_l00017}{App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\textbackslash{}\$db}}.



\doxysubsection{Documentación de funciones miembro}
\Hypertarget{classApp_1_1Controllers_1_1StatsController_af2a1c7f7fb5c2ec3ddc6a82c7c9b5944}\label{classApp_1_1Controllers_1_1StatsController_af2a1c7f7fb5c2ec3ddc6a82c7c9b5944} 
\index{App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}!getAllStatsForPage@{getAllStatsForPage}}
\index{getAllStatsForPage@{getAllStatsForPage}!App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}}
\doxysubsubsection{\texorpdfstring{getAllStatsForPage()}{getAllStatsForPage()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\+::get\+All\+Stats\+For\+Page (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Obtiene todas las estadísticas necesarias para la página de estadísticas. 

\begin{DoxyReturn}{Devuelve}
array Todas las estadísticas formateadas para la plantilla 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{StatsController_8php_source_l00116}{116}} del archivo \mbox{\hyperlink{StatsController_8php_source}{Stats\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00117\ \ \ \ \ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \$totalFungiQuery\ =\ \textcolor{stringliteral}{"{}SELECT\ COUNT(*)\ as\ count\ FROM\ fungi"{}};}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \$totalFungiResult\ =\ \$this-\/>db-\/>query(\$totalFungiQuery);}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \$totalFungi\ =\ (\$totalFungiResult\ ===\ \textcolor{keyword}{false})\ ?\ 0\ :\ \$totalFungiResult-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC)[\textcolor{stringliteral}{'count'}];}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \$totalUsersQuery\ =\ \textcolor{stringliteral}{"{}SELECT\ COUNT(*)\ as\ count\ FROM\ users"{}};}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \$totalUsersResult\ =\ \$this-\/>db-\/>query(\$totalUsersQuery);}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \$totalUsers\ =\ (\$totalUsersResult\ ===\ \textcolor{keyword}{false})\ ?\ 0\ :\ \$totalUsersResult-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC)[\textcolor{stringliteral}{'count'}];}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \$edibilityQuery\ =\ \textcolor{stringliteral}{"{}SELECT\ edibility,\ COUNT(*)\ as\ count\ FROM\ fungi\ WHERE\ edibility\ IS\ NOT\ NULL\ AND\ edibility\ !=\ ''\ GROUP\ BY\ edibility\ ORDER\ BY\ count\ DESC"{}};\ }
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \$edibilityResult\ =\ \$this-\/>db-\/>query(\$edibilityQuery);}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \$edibilityStats\ =\ (\$edibilityResult\ ===\ \textcolor{keyword}{false})\ ?\ []\ :\ \$edibilityResult-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \$familiesStats\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_ac11f08ebb9f334bedbba480533be6e07}{getFamilyDistribution}}(10);}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \$topLiked\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_ac15d7095c544e0023e61febc70e6e690}{getTopLiked}}();}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \$topFavorites\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a33d5205f64fa0acd29b3416a6b5b5308}{getTopFavorites}}();}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'total\_fungi'}\ =>\ \$totalFungi,\ \textcolor{stringliteral}{'total\_users'}\ =>\ \$totalUsers,\ \textcolor{stringliteral}{'edibility'}\ =>\ \$edibilityStats,}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'families'}\ =>\ \$familiesStats,\ \textcolor{stringliteral}{'popular'}\ =>\ \$topLiked,\ \textcolor{stringliteral}{'favorites'}\ =>\ \$topFavorites}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\(\backslash\)Exception\ \$e)\ \{}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ error\_log(\textcolor{stringliteral}{"{}Error\ al\ obtener\ estadísticas:\ "{}}\ .\ \$e-\/>getMessage());}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'total\_fungi'}\ =>\ 0,\ \textcolor{stringliteral}{'total\_users'}\ =>\ 0,\ \textcolor{stringliteral}{'edibility'}\ =>\ [],\ \textcolor{stringliteral}{'families'}\ =>\ [],}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'popular'}\ =>\ [],\ \textcolor{stringliteral}{'favorites'}\ =>\ []}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00143\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{StatsController_8php_source_l00085}{App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\textbackslash{}get\+Family\+Distribution()}}, \mbox{\hyperlink{StatsController_8php_source_l00060}{App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\textbackslash{}get\+Top\+Favorites()}} y \mbox{\hyperlink{StatsController_8php_source_l00034}{App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\textbackslash{}get\+Top\+Liked()}}.



Referenciado por \mbox{\hyperlink{StatsController_8php_source_l00156}{App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\textbackslash{}statistics\+Page\+Handler()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1StatsController_af2a1c7f7fb5c2ec3ddc6a82c7c9b5944_cgraph}
\end{center}
\end{figure}
Gráfico de llamadas a esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1StatsController_af2a1c7f7fb5c2ec3ddc6a82c7c9b5944_icgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1StatsController_a54135d721d270bd3dec13083d4051dc6}\label{classApp_1_1Controllers_1_1StatsController_a54135d721d270bd3dec13083d4051dc6} 
\index{App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}!getBaseUrl@{getBaseUrl}}
\index{getBaseUrl@{getBaseUrl}!App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}}
\doxysubsubsection{\texorpdfstring{getBaseUrl()}{getBaseUrl()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\+::get\+Base\+Url (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Obtiene la URL base del sitio. 

\begin{DoxyReturn}{Devuelve}
string URL base del sitio 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{StatsController_8php_source_l00169}{169}} del archivo \mbox{\hyperlink{StatsController_8php_source}{Stats\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00170\ \ \ \ \ \{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \$protocol\ =\ isset(\$\_SERVER[\textcolor{stringliteral}{'HTTPS'}])\ \&\&\ \$\_SERVER[\textcolor{stringliteral}{'HTTPS'}]\ ===\ \textcolor{stringliteral}{'on'}\ ?\ \textcolor{stringliteral}{'https://'}\ :\ \textcolor{stringliteral}{'http://'};}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \$host\ =\ \$\_SERVER[\textcolor{stringliteral}{'HTTP\_HOST'}];}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$protocol\ .\ \$host;}
\DoxyCodeLine{00174\ \ \ \ \ \}}

\end{DoxyCode}


Referenciado por \mbox{\hyperlink{StatsController_8php_source_l00156}{App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\textbackslash{}statistics\+Page\+Handler()}}.

Gráfico de llamadas a esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1StatsController_a54135d721d270bd3dec13083d4051dc6_icgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1StatsController_ac11f08ebb9f334bedbba480533be6e07}\label{classApp_1_1Controllers_1_1StatsController_ac11f08ebb9f334bedbba480533be6e07} 
\index{App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}!getFamilyDistribution@{getFamilyDistribution}}
\index{getFamilyDistribution@{getFamilyDistribution}!App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}}
\doxysubsubsection{\texorpdfstring{getFamilyDistribution()}{getFamilyDistribution()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\+::get\+Family\+Distribution (\begin{DoxyParamCaption}\item[{}]{\$limit = {\ttfamily 10} }\end{DoxyParamCaption})}



Obtiene la distribución de hongos por familia. 


\begin{DoxyParams}[1]{Parámetros}
int & {\em \$limit} & Número máximo de familias a retornar \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array Distribución de hongos por familia 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{StatsController_8php_source_l00085}{85}} del archivo \mbox{\hyperlink{StatsController_8php_source}{Stats\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00086\ \ \ \ \ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Consulta\ optimizada\ que\ utiliza\ la\ tabla\ taxonomy\ para\ obtener\ datos\ más\ precisos}}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \$result\ =\ \$this-\/>db-\/>query(}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SELECT\ t.family\ as\ name,\ COUNT(*)\ as\ count\ FROM\ taxonomy\ t}}
\DoxyCodeLine{00091\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ JOIN\ fungi\ f\ ON\ t.fungi\_id\ =\ f.id\ WHERE\ t.family\ IS\ NOT\ NULL\ AND\ t.family\ !=\ ''\ }}
\DoxyCodeLine{00092\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AND\ t.family\ NOT\ LIKE\ '\%unknown\%'\ AND\ t.family\ NOT\ LIKE\ '\%sin\ clasificar\%'}}
\DoxyCodeLine{00093\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GROUP\ BY\ t.family\ ORDER\ BY\ count\ DESC\ LIMIT\ \$limit"{}}}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$result\ ===\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error\_log(\textcolor{stringliteral}{"{}Error\ al\ obtener\ distribución\ por\ familia:\ Consulta\ fallida"{}});}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [];}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \$families\ =\ \$result-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Procesar\ nombres\ de\ familia\ para\ mejorar\ visualización}}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\$families\ as\ \&\$family)\ \{}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Convertir\ primera\ letra\ en\ mayúscula\ y\ resto\ en\ minúscula\ para\ uniformidad}}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isset(\$family[\textcolor{stringliteral}{'name'}]))\ \$family[\textcolor{stringliteral}{'name'}]\ =\ ucfirst(strtolower(\$family[\textcolor{stringliteral}{'name'}]));}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$families;}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\(\backslash\)Exception\ \$e)\ \{}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ error\_log(\textcolor{stringliteral}{"{}Error\ al\ obtener\ distribución\ por\ familia:\ "{}}\ .\ \$e-\/>getMessage());}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [];}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00110\ \ \ \ \ \}}

\end{DoxyCode}


Referenciado por \mbox{\hyperlink{StatsController_8php_source_l00116}{App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\textbackslash{}get\+All\+Stats\+For\+Page()}}.

Gráfico de llamadas a esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1StatsController_ac11f08ebb9f334bedbba480533be6e07_icgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1StatsController_a33d5205f64fa0acd29b3416a6b5b5308}\label{classApp_1_1Controllers_1_1StatsController_a33d5205f64fa0acd29b3416a6b5b5308} 
\index{App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}!getTopFavorites@{getTopFavorites}}
\index{getTopFavorites@{getTopFavorites}!App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}}
\doxysubsubsection{\texorpdfstring{getTopFavorites()}{getTopFavorites()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\+::get\+Top\+Favorites (\begin{DoxyParamCaption}\item[{}]{\$limit = {\ttfamily 5} }\end{DoxyParamCaption})}



Obtiene los hongos más añadidos a favoritos. 


\begin{DoxyParams}[1]{Parámetros}
int & {\em \$limit} & Número máximo de resultados a retornar \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array Los hongos más añadidos a favoritos 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{StatsController_8php_source_l00060}{60}} del archivo \mbox{\hyperlink{StatsController_8php_source}{Stats\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00061\ \ \ \ \ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \$result\ =\ \$this-\/>db-\/>query(}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SELECT\ f.id,\ f.name,\ COUNT(uf.id)\ as\ favorites\ FROM\ fungi\ f}}
\DoxyCodeLine{00065\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ JOIN\ user\_favorites\ uf\ ON\ f.id\ =\ uf.fungi\_id\ GROUP\ BY\ f.id}}
\DoxyCodeLine{00066\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ORDER\ BY\ COUNT(uf.id)\ DESC\ LIMIT\ \$limit"{}}}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$result\ ===\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error\_log(\textcolor{stringliteral}{"{}Error\ al\ obtener\ hongos\ favoritos:\ Consulta\ fallida"{}});}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [];}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$result-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\(\backslash\)Exception\ \$e)\ \{}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ error\_log(\textcolor{stringliteral}{"{}Error\ al\ obtener\ hongos\ favoritos:\ "{}}\ .\ \$e-\/>getMessage());}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [];}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00077\ \ \ \ \ \}}

\end{DoxyCode}


Referenciado por \mbox{\hyperlink{StatsController_8php_source_l00116}{App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\textbackslash{}get\+All\+Stats\+For\+Page()}}.

Gráfico de llamadas a esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1StatsController_a33d5205f64fa0acd29b3416a6b5b5308_icgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1StatsController_ac15d7095c544e0023e61febc70e6e690}\label{classApp_1_1Controllers_1_1StatsController_ac15d7095c544e0023e61febc70e6e690} 
\index{App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}!getTopLiked@{getTopLiked}}
\index{getTopLiked@{getTopLiked}!App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}}
\doxysubsubsection{\texorpdfstring{getTopLiked()}{getTopLiked()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\+::get\+Top\+Liked (\begin{DoxyParamCaption}\item[{}]{\$limit = {\ttfamily 5} }\end{DoxyParamCaption})}



Obtiene los hongos más likeados. 


\begin{DoxyParams}[1]{Parámetros}
int & {\em \$limit} & Número máximo de resultados a retornar \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array Los hongos con más likes 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{StatsController_8php_source_l00034}{34}} del archivo \mbox{\hyperlink{StatsController_8php_source}{Stats\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00035\ \ \ \ \ \{}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \$result\ =\ \$this-\/>db-\/>query(}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SELECT\ f.id,\ f.name,\ COUNT(ul.id)\ as\ likes\ FROM\ fungi\ f}}
\DoxyCodeLine{00039\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ JOIN\ user\_likes\ ul\ ON\ f.id\ =\ ul.fungi\_id\ GROUP\ BY\ f.id}}
\DoxyCodeLine{00040\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ORDER\ BY\ COUNT(ul.id)\ DESC\ LIMIT\ \$limit"{}}}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$result\ ===\ \textcolor{keyword}{false})\ \{}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error\_log(\textcolor{stringliteral}{"{}Error\ al\ obtener\ hongos\ más\ likeados:\ Consulta\ fallida"{}});}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [];}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$result-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\(\backslash\)Exception\ \$e)\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ error\_log(\textcolor{stringliteral}{"{}Error\ al\ obtener\ hongos\ más\ likeados:\ "{}}\ .\ \$e-\/>getMessage());}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [];}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00052\ \ \ \ \ \}}

\end{DoxyCode}


Referenciado por \mbox{\hyperlink{StatsController_8php_source_l00116}{App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\textbackslash{}get\+All\+Stats\+For\+Page()}}.

Gráfico de llamadas a esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1StatsController_ac15d7095c544e0023e61febc70e6e690_icgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1StatsController_a13a0ac992567acd018968d78f7a2201c}\label{classApp_1_1Controllers_1_1StatsController_a13a0ac992567acd018968d78f7a2201c} 
\index{App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}!statisticsPageHandler@{statisticsPageHandler}}
\index{statisticsPageHandler@{statisticsPageHandler}!App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}}
\doxysubsubsection{\texorpdfstring{statisticsPageHandler()}{statisticsPageHandler()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\+::statistics\+Page\+Handler (\begin{DoxyParamCaption}\item[{}]{\$twig,  }\item[{}]{\$db,  }\item[{}]{\$session }\end{DoxyParamCaption})}



Manejador de la página de estadísticas. 

Este método actúa como handler para la ruta de estadísticas, devolviendo los datos necesarios para renderizar la página.


\begin{DoxyParams}[1]{Parámetros}
object & {\em \$twig} & Instancia de Twig \\
\hline
object & {\em \$db} & Instancia de la conexión a base de datos \\
\hline
object & {\em \$session} & Controlador de sesión \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array Datos para la plantilla de estadísticas 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{StatsController_8php_source_l00156}{156}} del archivo \mbox{\hyperlink{StatsController_8php_source}{Stats\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00157\ \ \ \ \ \{}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \$stats\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_af2a1c7f7fb5c2ec3ddc6a82c7c9b5944}{getAllStatsForPage}}();}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(\$stats[\textcolor{stringliteral}{'families'}]))\ error\_log(\textcolor{stringliteral}{"{}Advertencia:\ No\ hay\ datos\ de\ familias\ disponibles\ para\ la\ vista\ de\ estadísticas"{}});}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [\ \textcolor{stringliteral}{'title'}\ =>\ \_(\textcolor{stringliteral}{'Estadísticas'}),\ \textcolor{stringliteral}{'stats'}\ =>\ \$stats,}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'api\_url'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1StatsController_a54135d721d270bd3dec13083d4051dc6}{getBaseUrl}}(),\ \textcolor{stringliteral}{'debug\_families'}\ =>\ !empty(\$stats[\textcolor{stringliteral}{'families'}])\ ];}
\DoxyCodeLine{00162\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{StatsController_8php_source_l00116}{App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\textbackslash{}get\+All\+Stats\+For\+Page()}} y \mbox{\hyperlink{StatsController_8php_source_l00169}{App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\textbackslash{}get\+Base\+Url()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1StatsController_a13a0ac992567acd018968d78f7a2201c_cgraph}
\end{center}
\end{figure}


\doxysubsection{Documentación de datos miembro}
\Hypertarget{classApp_1_1Controllers_1_1StatsController_acd274f9dac4bd8fb0b90261c3d971abd}\label{classApp_1_1Controllers_1_1StatsController_acd274f9dac4bd8fb0b90261c3d971abd} 
\index{App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}!\$db@{\$db}}
\index{\$db@{\$db}!App\textbackslash{}Controllers\textbackslash{}StatsController@{App\textbackslash{}Controllers\textbackslash{}StatsController}}
\doxysubsubsection{\texorpdfstring{\$db}{\$db}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\+::\$db\hspace{0.3cm}{\ttfamily [private]}}



Definición en la línea \mbox{\hyperlink{StatsController_8php_source_l00017}{17}} del archivo \mbox{\hyperlink{StatsController_8php_source}{Stats\+Controller.\+php}}.



Referenciado por \mbox{\hyperlink{StatsController_8php_source_l00024}{App\textbackslash{}\+Controllers\textbackslash{}\+Stats\+Controller\textbackslash{}\+\_\+\+\_\+construct()}}.



La documentación de esta clase está generada del siguiente archivo\+:\begin{DoxyCompactItemize}
\item 
src/controllers/\mbox{\hyperlink{StatsController_8php}{Stats\+Controller.\+php}}\end{DoxyCompactItemize}
