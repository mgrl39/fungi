\doxysection{Referencia de la clase App\textbackslash{}Controllers\textbackslash{}Admin\+Controller}
\hypertarget{classApp_1_1Controllers_1_1AdminController}{}\label{classApp_1_1Controllers_1_1AdminController}\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}


Controlador para funciones administrativas simplificado.  




Diagrama de colaboración de App\textbackslash{}Controllers\textbackslash{}Admin\+Controller\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=248pt]{classApp_1_1Controllers_1_1AdminController__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Métodos públicos}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a8f49eab2f797736caa68d5704b76c038}{\+\_\+\+\_\+construct}} (\$db, \$session, \$stats\+Controller=null)
\begin{DoxyCompactList}\small\item\em Constructor del controlador de administración. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_abea8f5ea53a9b14a07767d8481d5eee8}{create\+Fungi\+Handler}} ()
\begin{DoxyCompactList}\small\item\em Manejador para crear un nuevo hongo. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a39bd65ac3c1aeaea84fe9048dcb452b6}{create\+User\+Handler}} ()
\begin{DoxyCompactList}\small\item\em Manejador para crear un nuevo usuario. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a56070873896a9cb086b96abc3e8425f3}{dashboard\+Handler}} ()
\begin{DoxyCompactList}\small\item\em Manejador para el dashboard. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_abe1bf9ffe4082365edaeceb053a293a4}{delete\+Fungi\+Handler}} ()
\begin{DoxyCompactList}\small\item\em Manejador para eliminar un hongo. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_aa3f5ebc263b8aad49be63ebc3cf50faf}{delete\+Image\+Handler}} ()
\begin{DoxyCompactList}\small\item\em Manejador para eliminar una imagen de un hongo. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_ab0c4d838fb24bec663a7c2598f94eab1}{delete\+User\+Handler}} ()
\begin{DoxyCompactList}\small\item\em Manejador para eliminar un usuario. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a8f7d11c870220fc9b7a6c1e1de858885}{edit\+Fungi\+Handler}} ()
\begin{DoxyCompactList}\small\item\em Manejador para editar un hongo. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a2c96f0cf4bfcc3b465d6c23e5eb2a11a}{edit\+User\+Handler}} ()
\begin{DoxyCompactList}\small\item\em Manejador para editar un usuario. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a94e643c8c9a1c41aa99e0c12ad023c99}{fungi\+Handler}} ()
\begin{DoxyCompactList}\small\item\em Manejador para la gestión de hongos. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a3a9361b35478b054476a4119d92c953f}{users\+Handler}} ()
\begin{DoxyCompactList}\small\item\em Manejador para gestión de usuarios. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Métodos privados}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}} (\$text)
\begin{DoxyCompactList}\small\item\em Traduce un texto usando el dominio admin. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Atributos privados}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a58fcd49448b51833b95e5458478cc78f}{\$db}}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_abaecdc9bc8e75441c253e5214190a97f}{\$fungi\+Controller}}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_ae1f931a6d5207c384593aa6e564f6d95}{\$lang\+Controller}}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_afb44d06f307ac614afa172e41fed345d}{\$session}}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a9a91cb5f6aab29cbe857940f72305f0c}{\$user\+Controller}}
\end{DoxyCompactItemize}


\doxysubsection{Descripción detallada}
Controlador para funciones administrativas simplificado. 

Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00009}{9}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.



\doxysubsection{Documentación de constructores y destructores}
\Hypertarget{classApp_1_1Controllers_1_1AdminController_a8f49eab2f797736caa68d5704b76c038}\label{classApp_1_1Controllers_1_1AdminController_a8f49eab2f797736caa68d5704b76c038} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!\_\_construct@{\_\_construct}}
\index{\_\_construct@{\_\_construct}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{\_\_construct()}{\_\_construct()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::\+\_\+\+\_\+construct (\begin{DoxyParamCaption}\item[{}]{\$db,  }\item[{}]{\$session,  }\item[{}]{\$stats\+Controller = {\ttfamily null} }\end{DoxyParamCaption})}



Constructor del controlador de administración. 



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00020}{20}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00021\ \ \ \ \ \{}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \$this-\/>db\ =\ \mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a58fcd49448b51833b95e5458478cc78f}{\$db}};}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \$this-\/>session\ =\ \mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_afb44d06f307ac614afa172e41fed345d}{\$session}};}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \$this-\/>userController\ =\ \textcolor{keyword}{new}\ UserController(\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a58fcd49448b51833b95e5458478cc78f}{\$db}},\ \mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_afb44d06f307ac614afa172e41fed345d}{\$session}});}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \$this-\/>fungiController\ =\ \textcolor{keyword}{new}\ FungiController(\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a58fcd49448b51833b95e5458478cc78f}{\$db}});}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \$this-\/>langController\ =\ \textcolor{keyword}{new}\ LangController();}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Asegurar\ que\ el\ dominio\ admin\ esté\ cargado}}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \$this-\/>langController-\/>loadTextDomain(\textcolor{stringliteral}{'admin'});}
\DoxyCodeLine{00030\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{AdminController_8php_source_l00011}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}\$db}} y \mbox{\hyperlink{AdminController_8php_source_l00012}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}\$session}}.



\doxysubsection{Documentación de funciones miembro}
\Hypertarget{classApp_1_1Controllers_1_1AdminController_abea8f5ea53a9b14a07767d8481d5eee8}\label{classApp_1_1Controllers_1_1AdminController_abea8f5ea53a9b14a07767d8481d5eee8} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!createFungiHandler@{createFungiHandler}}
\index{createFungiHandler@{createFungiHandler}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{createFungiHandler()}{createFungiHandler()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::create\+Fungi\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Manejador para crear un nuevo hongo. 



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00234}{234}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00235\ \ \ \ \ \{}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$this-\/>session-\/>isAdmin())\ \{}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /'});}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \$message\ =\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \$error\ =\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$\_SERVER[\textcolor{stringliteral}{'REQUEST\_METHOD'}]\ ===\ \textcolor{stringliteral}{'POST'})\ \{}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \$name\ =\ \$\_POST[\textcolor{stringliteral}{'name'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \$edibility\ =\ \$\_POST[\textcolor{stringliteral}{'edibility'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \$habitat\ =\ \$\_POST[\textcolor{stringliteral}{'habitat'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(\$name)\ ||\ empty(\$edibility)\ ||\ empty(\$habitat))\ \{}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$error\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Los\ campos\ nombre\ científico,\ comestibilidad\ y\ hábitat\ son\ obligatorios'});}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>beginTransaction();}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Insertar\ en\ la\ tabla\ fungi}}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}INSERT\ INTO\ fungi\ (name,\ edibility,\ habitat,\ observations,\ common\_name,\ synonym)\ }}
\DoxyCodeLine{00258\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VALUES\ (?,\ ?,\ ?,\ ?,\ ?,\ ?)"{}},}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$name,}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$edibility,}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$habitat,}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$\_POST[\textcolor{stringliteral}{'observations'}]\ ??\ \textcolor{stringliteral}{''},}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$\_POST[\textcolor{stringliteral}{'common\_name'}]\ ??\ \textcolor{stringliteral}{''},}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$\_POST[\textcolor{stringliteral}{'synonym'}]\ ??\ \textcolor{stringliteral}{''}}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ]}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Obtener\ el\ ID\ del\ hongo\ recién\ creado}}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$result\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ LAST\_INSERT\_ID()\ as\ id"{}});}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$fungi\ =\ \$result-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$fungiId\ =\ \$fungi[\textcolor{stringliteral}{'id'}]\ ??\ 0;}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$fungiId)\ \{}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ new\ \(\backslash\)Exception(\$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Error\ al\ obtener\ el\ ID\ del\ hongo\ creado'}));}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Insertar\ características\ (si\ las\ hay)}}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$cap\ =\ \$\_POST[\textcolor{stringliteral}{'cap'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$hymenium\ =\ \$\_POST[\textcolor{stringliteral}{'hymenium'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$stipe\ =\ \$\_POST[\textcolor{stringliteral}{'stipe'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$flesh\ =\ \$\_POST[\textcolor{stringliteral}{'flesh'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!empty(\$cap)\ ||\ !empty(\$hymenium)\ ||\ !empty(\$stipe)\ ||\ !empty(\$flesh))\ \{}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}INSERT\ INTO\ characteristics\ (fungi\_id,\ cap,\ hymenium,\ stipe,\ flesh)\ }}
\DoxyCodeLine{00287\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VALUES\ (?,\ ?,\ ?,\ ?,\ ?)"{}},}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\$fungiId,\ \$cap,\ \$hymenium,\ \$stipe,\ \$flesh]}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Insertar\ taxonomía\ (si\ la\ hay)}}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$kingdom\ =\ \$\_POST[\textcolor{stringliteral}{'kingdom'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$phylum\ =\ \$\_POST[\textcolor{stringliteral}{'phylum'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$class\ =\ \$\_POST[\textcolor{stringliteral}{'class'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$order\ =\ \$\_POST[\textcolor{stringliteral}{'order'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$family\ =\ \$\_POST[\textcolor{stringliteral}{'family'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$genus\ =\ \$\_POST[\textcolor{stringliteral}{'genus'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!empty(\$kingdom)\ ||\ !empty(\$phylum)\ ||\ !empty(\$class)\ ||\ }
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ !empty(\$order)\ ||\ !empty(\$family)\ ||\ !empty(\$genus))\ \{}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}INSERT\ INTO\ taxonomy\ (fungi\_id,\ kingdom,\ phylum,\ class,\ \`{}order`,\ family,\ genus)\ }}
\DoxyCodeLine{00304\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ VALUES\ (?,\ ?,\ ?,\ ?,\ ?,\ ?,\ ?)"{}},}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\$fungiId,\ \$kingdom,\ \$phylum,\ \$class,\ \$order,\ \$family,\ \$genus]}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Procesar\ imágenes\ (si\ las\ hay)}}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isset(\$\_FILES[\textcolor{stringliteral}{'fungi\_images'}])\ \&\&\ !empty(\$\_FILES[\textcolor{stringliteral}{'fungi\_images'}][\textcolor{stringliteral}{'name'}][0]))\ \{}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$uploadDir\ =\ \textcolor{stringliteral}{'uploads/fungi/'};}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!file\_exists(\$uploadDir))\ \{}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mkdir(\$uploadDir,\ 0777,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Obtener\ configuración\ de\ imagen}}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$configResult\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ *\ FROM\ image\_config\ WHERE\ config\_key\ =\ 'upload\_path'\ LIMIT\ 1"{}});}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$config\ =\ \$configResult-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$configKey\ =\ \$config\ ?\ \$config[\textcolor{stringliteral}{'config\_key'}]\ :\ \textcolor{stringliteral}{'upload\_path'};}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Procesar\ cada\ imagen}}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$images\ =\ \$\_FILES[\textcolor{stringliteral}{'fungi\_images'}];}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$count\ =\ count(\$images[\textcolor{stringliteral}{'name'}]);}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\$i\ =\ 0;\ \$i\ <\ \$count;\ \$i++)\ \{}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$images[\textcolor{stringliteral}{'error'}][\$i]\ ===\ 0)\ \{}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$filename\ =\ \$fungiId\ .\ \textcolor{charliteral}{'\_'}\ .\ time()\ .\ \textcolor{charliteral}{'\_'}\ .\ \$i\ .\ \textcolor{charliteral}{'\_'}\ .\ basename(\$images[\textcolor{stringliteral}{'name'}][\$i]);}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$destination\ =\ \$uploadDir\ .\ \$filename;}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (move\_uploaded\_file(\$images[\textcolor{stringliteral}{'tmp\_name'}][\$i],\ \$destination))\ \{}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Guardar\ en\ la\ tabla\ images}}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}INSERT\ INTO\ images\ (filename,\ config\_key,\ description)\ VALUES\ (?,\ ?,\ ?)"{}},}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\$filename,\ \$configKey,\ \textcolor{stringliteral}{"{}Imagen\ de\ \$name"{}}]}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Obtener\ el\ ID\ de\ la\ imagen}}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$imageResult\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ LAST\_INSERT\_ID()\ as\ id"{}});}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$image\ =\ \$imageResult-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$imageId\ =\ \$image[\textcolor{stringliteral}{'id'}]\ ??\ 0;}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$imageId)\ \{}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Relacionar\ con\ el\ hongo}}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}INSERT\ INTO\ fungi\_images\ (fungi\_id,\ image\_id)\ VALUES\ (?,\ ?)"{}},}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\$fungiId,\ \$imageId]}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>commit();}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/fungi?created=true'});}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\(\backslash\)Exception\ \$e)\ \{}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>rollBack();}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$error\ =\ \textcolor{stringliteral}{'Error:\ '}\ .\ \$e-\/>getMessage();}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'title'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Crear\ Hongo'}),}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'message'}\ =>\ \$message,}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ \$error}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00369\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{AdminController_8php_source_l00038}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}translate()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1AdminController_abea8f5ea53a9b14a07767d8481d5eee8_cgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1AdminController_a39bd65ac3c1aeaea84fe9048dcb452b6}\label{classApp_1_1Controllers_1_1AdminController_a39bd65ac3c1aeaea84fe9048dcb452b6} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!createUserHandler@{createUserHandler}}
\index{createUserHandler@{createUserHandler}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{createUserHandler()}{createUserHandler()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::create\+User\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Manejador para crear un nuevo usuario. 



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00100}{100}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00101\ \ \ \ \ \{}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$this-\/>session-\/>isAdmin())\ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /'});}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \$message\ =\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \$error\ =\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$\_SERVER[\textcolor{stringliteral}{'REQUEST\_METHOD'}]\ ===\ \textcolor{stringliteral}{'POST'})\ \{}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \$username\ =\ \$\_POST[\textcolor{stringliteral}{'username'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \$email\ =\ \$\_POST[\textcolor{stringliteral}{'email'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \$password\ =\ \$\_POST[\textcolor{stringliteral}{'password'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \$role\ =\ \$\_POST[\textcolor{stringliteral}{'role'}]\ ??\ \textcolor{stringliteral}{'user'};}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(\$username)\ ||\ empty(\$email)\ ||\ empty(\$password))\ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$error\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Todos\ los\ campos\ son\ obligatorios'});}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Verificar\ si\ el\ nombre\ de\ usuario\ o\ email\ ya\ existe}}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$checkQuery\ =\ \$this-\/>db-\/>query(}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SELECT\ COUNT(*)\ as\ total\ FROM\ users\ WHERE\ username\ =\ ?\ OR\ email\ =\ ?"{}},}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\$username,\ \$email]}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$result\ =\ \$checkQuery-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$result[\textcolor{stringliteral}{'total'}]\ >\ 0)\ \{}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$error\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'El\ nombre\ de\ usuario\ o\ email\ ya\ está\ en\ uso'});}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Generar\ hash\ de\ contraseña\ usando\ password\_hash\ nativo}}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$hashedPassword\ =\ password\_hash(\$password,\ PASSWORD\_DEFAULT);}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Insertar\ nuevo\ usuario}}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}INSERT\ INTO\ users\ (username,\ email,\ password\_hash,\ role)\ VALUES\ (?,\ ?,\ ?,\ ?)"{}},}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\$username,\ \$email,\ \$hashedPassword,\ \$role]}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/users?created=true'});}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\(\backslash\)Exception\ \$e)\ \{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$error\ =\ \textcolor{stringliteral}{'Error:\ '}\ .\ \$e-\/>getMessage();}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'title'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Crear\ Usuario'}),}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'message'}\ =>\ \$message,}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ \$error}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00153\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{AdminController_8php_source_l00038}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}translate()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1AdminController_a39bd65ac3c1aeaea84fe9048dcb452b6_cgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1AdminController_a56070873896a9cb086b96abc3e8425f3}\label{classApp_1_1Controllers_1_1AdminController_a56070873896a9cb086b96abc3e8425f3} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!dashboardHandler@{dashboardHandler}}
\index{dashboardHandler@{dashboardHandler}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{dashboardHandler()}{dashboardHandler()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::dashboard\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Manejador para el dashboard. 



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00046}{46}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00047\ \ \ \ \ \{}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$this-\/>session-\/>isAdmin())\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /'});}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Obtener\ estadísticas\ básicas}}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \$userQuery\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ COUNT(*)\ as\ total\ FROM\ users"{}});}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \$userData\ =\ \$userQuery-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \$totalUsers\ =\ \$userData[\textcolor{stringliteral}{'total'}]\ ??\ 0;}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \$fungiQuery\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ COUNT(*)\ as\ total\ FROM\ fungi"{}});}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \$fungiData\ =\ \$fungiQuery-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \$totalFungi\ =\ \$fungiData[\textcolor{stringliteral}{'total'}]\ ??\ 0;}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'title'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Panel\ de\ Administración'}),}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'totalUsers'}\ =>\ \$totalUsers,}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'totalFungi'}\ =>\ \$totalFungi,}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'dashboard'}\ =>\ true}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00068\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{AdminController_8php_source_l00038}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}translate()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1AdminController_a56070873896a9cb086b96abc3e8425f3_cgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1AdminController_abe1bf9ffe4082365edaeceb053a293a4}\label{classApp_1_1Controllers_1_1AdminController_abe1bf9ffe4082365edaeceb053a293a4} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!deleteFungiHandler@{deleteFungiHandler}}
\index{deleteFungiHandler@{deleteFungiHandler}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{deleteFungiHandler()}{deleteFungiHandler()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::delete\+Fungi\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Manejador para eliminar un hongo. 



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00595}{595}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00596\ \ \ \ \ \{}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$this-\/>session-\/>isAdmin())\ \{}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /'});}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \$fungiId\ =\ (int)\ (\$\_GET[\textcolor{stringliteral}{'id'}]\ ??\ 0);}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$fungiId\ \&\&\ !empty(\$\_SERVER[\textcolor{stringliteral}{'PATH\_INFO'}]))\ \{}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ \ \ \ \ \$parts\ =\ explode(\textcolor{charliteral}{'/'},\ trim(\$\_SERVER[\textcolor{stringliteral}{'PATH\_INFO'}],\ \textcolor{charliteral}{'/'}));}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \ \ \ \ \$fungiId\ =\ (int)\ end(\$parts);}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$fungiId)\ \{}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/fungi?error=invalidid'});}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>beginTransaction();}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Primero\ eliminamos\ las\ relaciones\ de\ imágenes}}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \ \ \ \ \$imageQuery\ =\ \$this-\/>db-\/>query(}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SELECT\ i.id,\ i.filename\ FROM\ images\ i\ }}
\DoxyCodeLine{00620\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ JOIN\ fungi\_images\ fi\ ON\ i.id\ =\ fi.image\_id\ }}
\DoxyCodeLine{00621\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WHERE\ fi.fungi\_id\ =\ ?"{}},\ }
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\$fungiId]}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ \ \ \ \ \$images\ =\ \$imageQuery-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\$images\ as\ \$image)\ \{}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Eliminar\ el\ archivo\ físico}}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$filePath\ =\ \textcolor{stringliteral}{'uploads/fungi/'}\ .\ \$image[\textcolor{stringliteral}{'filename'}];}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (file\_exists(\$filePath))\ \{}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unlink(\$filePath);}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Eliminar\ relación}}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}DELETE\ FROM\ fungi\_images\ WHERE\ image\_id\ =\ ?"{}},\ [\$image[\textcolor{stringliteral}{'id'}]]);}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Eliminar\ registro\ de\ imagen}}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}DELETE\ FROM\ images\ WHERE\ id\ =\ ?"{}},\ [\$image[\textcolor{stringliteral}{'id'}]]);}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Eliminar\ taxonomía}}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}DELETE\ FROM\ taxonomy\ WHERE\ fungi\_id\ =\ ?"{}},\ [\$fungiId]);}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Eliminar\ características}}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}DELETE\ FROM\ characteristics\ WHERE\ fungi\_id\ =\ ?"{}},\ [\$fungiId]);}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Eliminar\ likes\ y\ favoritos}}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}DELETE\ FROM\ user\_likes\ WHERE\ fungi\_id\ =\ ?"{}},\ [\$fungiId]);}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}DELETE\ FROM\ user\_favorites\ WHERE\ fungi\_id\ =\ ?"{}},\ [\$fungiId]);}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Finalmente\ eliminar\ el\ hongo}}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}DELETE\ FROM\ fungi\ WHERE\ id\ =\ ?"{}},\ [\$fungiId]);}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>commit();}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/fungi?deleted=true'});}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\(\backslash\)Exception\ \$e)\ \{}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>rollBack();}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/fungi?error='}\ .\ urlencode(\$e-\/>getMessage()));}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00660\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classApp_1_1Controllers_1_1AdminController_aa3f5ebc263b8aad49be63ebc3cf50faf}\label{classApp_1_1Controllers_1_1AdminController_aa3f5ebc263b8aad49be63ebc3cf50faf} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!deleteImageHandler@{deleteImageHandler}}
\index{deleteImageHandler@{deleteImageHandler}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{deleteImageHandler()}{deleteImageHandler()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::delete\+Image\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Manejador para eliminar una imagen de un hongo. 



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00747}{747}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00748\ \ \ \ \ \{}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$this-\/>session-\/>isAdmin())\ \{}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /'});}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ \$imageId\ =\ (int)\ (\$\_GET[\textcolor{stringliteral}{'image\_id'}]\ ??\ 0);}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ \$fungiId\ =\ (int)\ (\$\_GET[\textcolor{stringliteral}{'fungi\_id'}]\ ??\ 0);}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$imageId\ ||\ !\$fungiId)\ \{}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/fungi?error=invalidparams'});}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>beginTransaction();}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00765\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Obtener\ información\ de\ la\ imagen}}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ \ \ \ \ \$imageQuery\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ *\ FROM\ images\ WHERE\ id\ =\ ?"{}},\ [\$imageId]);}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ \ \ \ \ \$image\ =\ \$imageQuery-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Eliminar\ relación}}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}DELETE\ FROM\ fungi\_images\ WHERE\ fungi\_id\ =\ ?\ AND\ image\_id\ =\ ?"{}},\ [\$fungiId,\ \$imageId]);}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Eliminar\ archivo\ físico\ si\ existe}}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$image\ \&\&\ !empty(\$image[\textcolor{stringliteral}{'filename'}]))\ \{}
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$filePath\ =\ \textcolor{stringliteral}{'uploads/fungi/'}\ .\ \$image[\textcolor{stringliteral}{'filename'}];}
\DoxyCodeLine{00775\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (file\_exists(\$filePath))\ \{}
\DoxyCodeLine{00776\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unlink(\$filePath);}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Eliminar\ registro\ de\ la\ imagen}}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}DELETE\ FROM\ images\ WHERE\ id\ =\ ?"{}},\ [\$imageId]);}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00783\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>commit();}
\DoxyCodeLine{00784\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/edit-\/fungi?id='}\ .\ \$fungiId\ .\ \textcolor{stringliteral}{'\&imageDeleted=true'});}
\DoxyCodeLine{00785\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\(\backslash\)Exception\ \$e)\ \{}
\DoxyCodeLine{00786\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>rollBack();}
\DoxyCodeLine{00787\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/edit-\/fungi?id='}\ .\ \$fungiId\ .\ \textcolor{stringliteral}{'\&error='}\ .\ urlencode(\$e-\/>getMessage()));}
\DoxyCodeLine{00788\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00790\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classApp_1_1Controllers_1_1AdminController_ab0c4d838fb24bec663a7c2598f94eab1}\label{classApp_1_1Controllers_1_1AdminController_ab0c4d838fb24bec663a7c2598f94eab1} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!deleteUserHandler@{deleteUserHandler}}
\index{deleteUserHandler@{deleteUserHandler}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{deleteUserHandler()}{deleteUserHandler()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::delete\+User\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Manejador para eliminar un usuario. 



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00158}{158}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00159\ \ \ \ \ \{}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$this-\/>session-\/>isAdmin())\ \{}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /'});}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \$userId\ =\ (int)\ \$\_GET[\textcolor{stringliteral}{'id'}]\ ??\ 0;}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$userId\ \&\&\ !empty(\$\_SERVER[\textcolor{stringliteral}{'PATH\_INFO'}]))\ \{}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \ \ \$parts\ =\ explode(\textcolor{charliteral}{'/'},\ trim(\$\_SERVER[\textcolor{stringliteral}{'PATH\_INFO'}],\ \textcolor{charliteral}{'/'}));}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \$userId\ =\ (int)\ end(\$parts);}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Evitar\ eliminar\ al\ propio\ administrador}}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \$currentUser\ =\ \$this-\/>session-\/>getUserData();}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$currentUser[\textcolor{stringliteral}{'id'}]\ ==\ \$userId)\ \{}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/users?error=selfdelete'});}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Verificar\ si\ el\ usuario\ existe}}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \$checkQuery\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ role\ FROM\ users\ WHERE\ id\ =\ ?"{}},\ [\$userId]);}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \$user\ =\ \$checkQuery-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$user)\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/users?error=notfound'});}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Eliminar\ el\ usuario}}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \$result\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}DELETE\ FROM\ users\ WHERE\ id\ =\ ?"{}},\ [\$userId]);}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$result)\ \{}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/users?deleted=true'});}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/users?error=deletefailed'});}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\(\backslash\)Exception\ \$e)\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/users?error='}\ .\ urlencode(\$e-\/>getMessage()));}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00200\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classApp_1_1Controllers_1_1AdminController_a8f7d11c870220fc9b7a6c1e1de858885}\label{classApp_1_1Controllers_1_1AdminController_a8f7d11c870220fc9b7a6c1e1de858885} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!editFungiHandler@{editFungiHandler}}
\index{editFungiHandler@{editFungiHandler}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{editFungiHandler()}{editFungiHandler()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::edit\+Fungi\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Manejador para editar un hongo. 



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00374}{374}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00375\ \ \ \ \ \{}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$this-\/>session-\/>isAdmin())\ \{}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /'});}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \$fungiId\ =\ (int)\ (\$\_GET[\textcolor{stringliteral}{'id'}]\ ??\ 0);}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$fungiId\ \&\&\ !empty(\$\_SERVER[\textcolor{stringliteral}{'PATH\_INFO'}]))\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \$parts\ =\ explode(\textcolor{charliteral}{'/'},\ trim(\$\_SERVER[\textcolor{stringliteral}{'PATH\_INFO'}],\ \textcolor{charliteral}{'/'}));}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \$fungiId\ =\ (int)\ end(\$parts);}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Obtener\ datos\ del\ hongo}}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \$fungusQuery\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ *\ FROM\ fungi\ WHERE\ id\ =\ ?"{}},\ [\$fungiId]);}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \$fungus\ =\ \$fungusQuery-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$fungus)\ \{}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/fungi?error=notfound'});}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Obtener\ taxonomía}}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \$taxonomyQuery\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ *\ FROM\ taxonomy\ WHERE\ fungi\_id\ =\ ?"{}},\ [\$fungiId]);}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \$taxonomy\ =\ \$taxonomyQuery-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC)\ ?:\ [];}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Obtener\ características}}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \$characteristicsQuery\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ *\ FROM\ characteristics\ WHERE\ fungi\_id\ =\ ?"{}},\ [\$fungiId]);}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \$characteristics\ =\ \$characteristicsQuery-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC)\ ?:\ [];}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Obtener\ imágenes\ asociadas}}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \$imagesQuery\ =\ \$this-\/>db-\/>query(}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SELECT\ i.*\ FROM\ images\ i\ }}
\DoxyCodeLine{00407\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ JOIN\ fungi\_images\ fi\ ON\ i.id\ =\ fi.image\_id\ }}
\DoxyCodeLine{00408\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ WHERE\ fi.fungi\_id\ =\ ?"{}},\ }
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ [\$fungiId]}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \$fungusImages\ =\ \$imagesQuery-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC)\ ?:\ [];}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \$message\ =\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \$error\ =\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$\_SERVER[\textcolor{stringliteral}{'REQUEST\_METHOD'}]\ ===\ \textcolor{stringliteral}{'POST'})\ \{}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ \$name\ =\ \$\_POST[\textcolor{stringliteral}{'name'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ \$edibility\ =\ \$\_POST[\textcolor{stringliteral}{'edibility'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ \$habitat\ =\ \$\_POST[\textcolor{stringliteral}{'habitat'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(\$name)\ ||\ empty(\$edibility)\ ||\ empty(\$habitat))\ \{}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$error\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Los\ campos\ nombre\ científico,\ comestibilidad\ y\ hábitat\ son\ obligatorios'});}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>beginTransaction();}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Construir\ los\ campos\ a\ actualizar}}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$updates\ =\ [}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'name'}\ =>\ \$name,}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'edibility'}\ =>\ \$edibility,}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'habitat'}\ =>\ \$habitat,}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'observations'}\ =>\ \$\_POST[\textcolor{stringliteral}{'observations'}]\ ??\ \textcolor{stringliteral}{''},}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'common\_name'}\ =>\ \$\_POST[\textcolor{stringliteral}{'common\_name'}]\ ??\ \textcolor{stringliteral}{''},}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'synonym'}\ =>\ \$\_POST[\textcolor{stringliteral}{'synonym'}]\ ??\ \textcolor{stringliteral}{''}}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Construir\ la\ consulta\ dinámica\ para\ actualizar\ fungi}}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$setClause\ =\ [];}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$params\ =\ [];}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\$updates\ as\ \$field\ =>\ \$value)\ \{}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$setClause[]\ =\ \textcolor{stringliteral}{"{}\$field\ =\ ?"{}};}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$params[]\ =\ \$value;}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Añadir\ el\ ID\ al\ final\ de\ los\ parámetros}}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$params[]\ =\ \$fungiId;}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$sql\ =\ \textcolor{stringliteral}{"{}UPDATE\ fungi\ SET\ "{}}\ .\ implode(\textcolor{stringliteral}{',\ '},\ \$setClause)\ .\ \textcolor{stringliteral}{"{}\ WHERE\ id\ =\ ?"{}};}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$result\ =\ \$this-\/>db-\/>query(\$sql,\ \$params);}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Actualizar\ taxonomía}}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isset(\$\_POST[\textcolor{stringliteral}{'taxonomy'}])\ \&\&\ is\_array(\$\_POST[\textcolor{stringliteral}{'taxonomy'}]))\ \{}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$taxonomyData\ =\ \$\_POST[\textcolor{stringliteral}{'taxonomy'}];}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Verificar\ si\ existe\ taxonomía\ para\ este\ hongo}}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$taxonomyCheck\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ COUNT(*)\ as\ count\ FROM\ taxonomy\ WHERE\ fungi\_id\ =\ ?"{}},\ [\$fungiId]);}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$taxonomyExists\ =\ \$taxonomyCheck-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC)[\textcolor{stringliteral}{'count'}]\ >\ 0;}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$taxonomyExists)\ \{}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Actualizar\ registro\ existente}}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$taxSetClause\ =\ [];}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$taxParams\ =\ [];}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\$taxonomyData\ as\ \$field\ =>\ \$value)\ \{}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$taxSetClause[]\ =\ \textcolor{stringliteral}{"{}\$field\ =\ ?"{}};}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$taxParams[]\ =\ \$value;}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Añadir\ el\ fungi\_id\ al\ final\ de\ los\ parámetros}}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$taxParams[]\ =\ \$fungiId;}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$taxSql\ =\ \textcolor{stringliteral}{"{}UPDATE\ taxonomy\ SET\ "{}}\ .\ implode(\textcolor{stringliteral}{',\ '},\ \$taxSetClause)\ .\ \textcolor{stringliteral}{"{}\ WHERE\ fungi\_id\ =\ ?"{}};}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(\$taxSql,\ \$taxParams);}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Insertar\ nuevo\ registro}}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$taxonomyData[\textcolor{stringliteral}{'fungi\_id'}]\ =\ \$fungiId;}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$taxFields\ =\ implode(\textcolor{stringliteral}{',\ '},\ array\_keys(\$taxonomyData));}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$taxPlaceholders\ =\ implode(\textcolor{stringliteral}{',\ '},\ array\_fill(0,\ count(\$taxonomyData),\ \textcolor{charliteral}{'?'}));}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}INSERT\ INTO\ taxonomy\ (\$taxFields)\ VALUES\ (\$taxPlaceholders)"{}},}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ array\_values(\$taxonomyData)}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Actualizar\ características}}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isset(\$\_POST[\textcolor{stringliteral}{'characteristics'}])\ \&\&\ is\_array(\$\_POST[\textcolor{stringliteral}{'characteristics'}]))\ \{}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$charData\ =\ \$\_POST[\textcolor{stringliteral}{'characteristics'}];}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Verificar\ si\ existen\ características\ para\ este\ hongo}}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$charCheck\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ COUNT(*)\ as\ count\ FROM\ characteristics\ WHERE\ fungi\_id\ =\ ?"{}},\ [\$fungiId]);}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$charExists\ =\ \$charCheck-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC)[\textcolor{stringliteral}{'count'}]\ >\ 0;}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$charExists)\ \{}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Actualizar\ registro\ existente}}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$charSetClause\ =\ [];}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$charParams\ =\ [];}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\$charData\ as\ \$field\ =>\ \$value)\ \{}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$charSetClause[]\ =\ \textcolor{stringliteral}{"{}\$field\ =\ ?"{}};}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$charParams[]\ =\ \$value;}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Añadir\ el\ fungi\_id\ al\ final\ de\ los\ parámetros}}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$charParams[]\ =\ \$fungiId;}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$charSql\ =\ \textcolor{stringliteral}{"{}UPDATE\ characteristics\ SET\ "{}}\ .\ implode(\textcolor{stringliteral}{',\ '},\ \$charSetClause)\ .\ \textcolor{stringliteral}{"{}\ WHERE\ fungi\_id\ =\ ?"{}};}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(\$charSql,\ \$charParams);}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Insertar\ nuevo\ registro}}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$charData[\textcolor{stringliteral}{'fungi\_id'}]\ =\ \$fungiId;}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$charFields\ =\ implode(\textcolor{stringliteral}{',\ '},\ array\_keys(\$charData));}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$charPlaceholders\ =\ implode(\textcolor{stringliteral}{',\ '},\ array\_fill(0,\ count(\$charData),\ \textcolor{charliteral}{'?'}));}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}INSERT\ INTO\ characteristics\ (\$charFields)\ VALUES\ (\$charPlaceholders)"{}},}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ array\_values(\$charData)}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Procesar\ nuevas\ imágenes}}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isset(\$\_FILES[\textcolor{stringliteral}{'fungi\_images'}])\ \&\&\ !empty(\$\_FILES[\textcolor{stringliteral}{'fungi\_images'}][\textcolor{stringliteral}{'name'}][0]))\ \{}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$uploadDir\ =\ \textcolor{stringliteral}{'uploads/fungi/'};}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!file\_exists(\$uploadDir))\ \{}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mkdir(\$uploadDir,\ 0777,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Obtener\ configuración\ de\ imagen}}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$configResult\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ *\ FROM\ image\_config\ WHERE\ config\_key\ =\ 'upload\_path'\ LIMIT\ 1"{}});}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$config\ =\ \$configResult-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$configKey\ =\ \$config\ ?\ \$config[\textcolor{stringliteral}{'config\_key'}]\ :\ \textcolor{stringliteral}{'upload\_path'};}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Procesar\ cada\ imagen}}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$images\ =\ \$\_FILES[\textcolor{stringliteral}{'fungi\_images'}];}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$count\ =\ count(\$images[\textcolor{stringliteral}{'name'}]);}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\$i\ =\ 0;\ \$i\ <\ \$count;\ \$i++)\ \{}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$images[\textcolor{stringliteral}{'error'}][\$i]\ ===\ 0)\ \{}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$filename\ =\ \$fungiId\ .\ \textcolor{charliteral}{'\_'}\ .\ time()\ .\ \textcolor{charliteral}{'\_'}\ .\ \$i\ .\ \textcolor{charliteral}{'\_'}\ .\ basename(\$images[\textcolor{stringliteral}{'name'}][\$i]);}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$destination\ =\ \$uploadDir\ .\ \$filename;}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (move\_uploaded\_file(\$images[\textcolor{stringliteral}{'tmp\_name'}][\$i],\ \$destination))\ \{}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Guardar\ en\ la\ tabla\ images}}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}INSERT\ INTO\ images\ (filename,\ config\_key,\ description)\ VALUES\ (?,\ ?,\ ?)"{}},}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\$filename,\ \$configKey,\ \textcolor{stringliteral}{"{}Imagen\ de\ \$name"{}}]}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Obtener\ el\ ID\ de\ la\ imagen}}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$imageResult\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ LAST\_INSERT\_ID()\ as\ id"{}});}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$image\ =\ \$imageResult-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$imageId\ =\ \$image[\textcolor{stringliteral}{'id'}]\ ??\ 0;}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$imageId)\ \{}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Relacionar\ con\ el\ hongo}}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}INSERT\ INTO\ fungi\_images\ (fungi\_id,\ image\_id)\ VALUES\ (?,\ ?)"{}},}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\$fungiId,\ \$imageId]}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>commit();}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/fungi?updated=true'});}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\(\backslash\)Exception\ \$e)\ \{}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>rollBack();}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$error\ =\ \textcolor{stringliteral}{'Error:\ '}\ .\ \$e-\/>getMessage();}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'title'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Editar\ Hongo'}),}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'fungus'}\ =>\ \$fungus,}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'taxonomy'}\ =>\ \$taxonomy,}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'characteristics'}\ =>\ \$characteristics,}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'fungusImages'}\ =>\ \$fungusImages,}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'message'}\ =>\ \$message,}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ \$error}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00590\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{AdminController_8php_source_l00038}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}translate()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1AdminController_a8f7d11c870220fc9b7a6c1e1de858885_cgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1AdminController_a2c96f0cf4bfcc3b465d6c23e5eb2a11a}\label{classApp_1_1Controllers_1_1AdminController_a2c96f0cf4bfcc3b465d6c23e5eb2a11a} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!editUserHandler@{editUserHandler}}
\index{editUserHandler@{editUserHandler}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{editUserHandler()}{editUserHandler()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::edit\+User\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Manejador para editar un usuario. 



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00665}{665}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00666\ \ \ \ \ \{}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$this-\/>session-\/>isAdmin())\ \{}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /'});}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ \$userId\ =\ (int)\ \$\_GET[\textcolor{stringliteral}{'id'}]\ ??\ 0;}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$userId\ \&\&\ !empty(\$\_SERVER[\textcolor{stringliteral}{'PATH\_INFO'}]))\ \{}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \ \ \ \ \$parts\ =\ explode(\textcolor{charliteral}{'/'},\ trim(\$\_SERVER[\textcolor{stringliteral}{'PATH\_INFO'}],\ \textcolor{charliteral}{'/'}));}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \ \ \ \ \$userId\ =\ (int)\ end(\$parts);}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00678\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Obtener\ datos\ del\ usuario}}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \$userQuery\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ *\ FROM\ users\ WHERE\ id\ =\ ?"{}},\ [\$userId]);}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ \$user\ =\ \$userQuery-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$user)\ \{}
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/users?error=notfound'});}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \$message\ =\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \$error\ =\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$\_SERVER[\textcolor{stringliteral}{'REQUEST\_METHOD'}]\ ===\ \textcolor{stringliteral}{'POST'})\ \{}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ \ \ \ \ \$username\ =\ \$\_POST[\textcolor{stringliteral}{'username'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \ \ \ \ \ \ \$email\ =\ \$\_POST[\textcolor{stringliteral}{'email'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \ \ \ \ \$role\ =\ \$\_POST[\textcolor{stringliteral}{'role'}]\ ??\ \textcolor{stringliteral}{'user'};}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \ \ \ \ \ \ \$password\ =\ \$\_POST[\textcolor{stringliteral}{'password'}]\ ??\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00696\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(\$username)\ ||\ empty(\$email))\ \{}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$error\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Los\ campos\ nombre\ de\ usuario\ y\ email\ son\ obligatorios'});}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Construir\ los\ campos\ a\ actualizar}}
\DoxyCodeLine{00700\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$updates\ =\ [}
\DoxyCodeLine{00701\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'username'}\ =>\ \$username,}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'email'}\ =>\ \$email,}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'role'}\ =>\ \$role}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Si\ se\ proporciona\ una\ nueva\ contraseña,\ actualizarla}}
\DoxyCodeLine{00707\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!empty(\$password))\ \{}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Usar\ password\_hash\ nativo\ en\ lugar\ de\ depender\ de\ AuthController}}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$updates[\textcolor{stringliteral}{'password\_hash'}]\ =\ password\_hash(\$password,\ PASSWORD\_DEFAULT);}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Construir\ la\ consulta\ dinámica}}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$setClause\ =\ [];}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$params\ =\ [];}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\$updates\ as\ \$field\ =>\ \$value)\ \{}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$setClause[]\ =\ \textcolor{stringliteral}{"{}\$field\ =\ ?"{}};}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$params[]\ =\ \$value;}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Añadir\ el\ ID\ al\ final\ de\ los\ parámetros}}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$params[]\ =\ \$userId;}
\DoxyCodeLine{00723\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00724\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$sql\ =\ \textcolor{stringliteral}{"{}UPDATE\ users\ SET\ "{}}\ .\ implode(\textcolor{stringliteral}{',\ '},\ \$setClause)\ .\ \textcolor{stringliteral}{"{}\ WHERE\ id\ =\ ?"{}};}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$result\ =\ \$this-\/>db-\/>query(\$sql,\ \$params);}
\DoxyCodeLine{00726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00727\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$result)\ \{}
\DoxyCodeLine{00728\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /admin/users?updated=true'});}
\DoxyCodeLine{00729\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$error\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Error\ al\ actualizar\ el\ usuario'});}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00735\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00736\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'title'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Editar\ Usuario'}),}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'user'}\ =>\ \$user,}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'message'}\ =>\ \$message,}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ \$error}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00742\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{AdminController_8php_source_l00038}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}translate()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1AdminController_a2c96f0cf4bfcc3b465d6c23e5eb2a11a_cgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1AdminController_a94e643c8c9a1c41aa99e0c12ad023c99}\label{classApp_1_1Controllers_1_1AdminController_a94e643c8c9a1c41aa99e0c12ad023c99} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!fungiHandler@{fungiHandler}}
\index{fungiHandler@{fungiHandler}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{fungiHandler()}{fungiHandler()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::fungi\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Manejador para la gestión de hongos. 



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00205}{205}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00206\ \ \ \ \ \{}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$this-\/>session-\/>isAdmin())\ \{}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /'});}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \$query\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ f.id,\ f.name,\ f.common\_name,\ f.edibility\ FROM\ fungi\ f\ ORDER\ BY\ f.id\ DESC"{}});}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \$fungi\ =\ \$query-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \$message\ =\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isset(\$\_GET[\textcolor{stringliteral}{'created'}])\ \&\&\ \$\_GET[\textcolor{stringliteral}{'created'}]\ ===\ \textcolor{stringliteral}{'true'})\ \{}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \$message\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Hongo\ creado\ correctamente'});}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (isset(\$\_GET[\textcolor{stringliteral}{'deleted'}])\ \&\&\ \$\_GET[\textcolor{stringliteral}{'deleted'}]\ ===\ \textcolor{stringliteral}{'true'})\ \{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ \$message\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Hongo\ eliminado\ correctamente'});}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (isset(\$\_GET[\textcolor{stringliteral}{'updated'}])\ \&\&\ \$\_GET[\textcolor{stringliteral}{'updated'}]\ ===\ \textcolor{stringliteral}{'true'})\ \{}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \$message\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Hongo\ actualizado\ correctamente'});}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'title'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Gestión\ de\ Hongos'}),}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'fungi'}\ =>\ \$fungi,}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'message'}\ =>\ \$message}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00229\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{AdminController_8php_source_l00038}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}translate()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1AdminController_a94e643c8c9a1c41aa99e0c12ad023c99_cgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}\label{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!translate@{translate}}
\index{translate@{translate}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{translate()}{translate()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::translate (\begin{DoxyParamCaption}\item[{}]{\$text }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Traduce un texto usando el dominio admin. 


\begin{DoxyParams}[1]{Parámetros}
string & {\em \$text} & Texto a traducir \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
string Texto traducido 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00038}{38}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00039\ \ \ \ \ \{}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>langController-\/>gettext(\$text,\ \textcolor{stringliteral}{'admin'});}
\DoxyCodeLine{00041\ \ \ \ \ \}}

\end{DoxyCode}


Referenciado por \mbox{\hyperlink{AdminController_8php_source_l00234}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}create\+Fungi\+Handler()}}, \mbox{\hyperlink{AdminController_8php_source_l00100}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}create\+User\+Handler()}}, \mbox{\hyperlink{AdminController_8php_source_l00046}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}dashboard\+Handler()}}, \mbox{\hyperlink{AdminController_8php_source_l00374}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}edit\+Fungi\+Handler()}}, \mbox{\hyperlink{AdminController_8php_source_l00665}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}edit\+User\+Handler()}}, \mbox{\hyperlink{AdminController_8php_source_l00205}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}fungi\+Handler()}} y \mbox{\hyperlink{AdminController_8php_source_l00073}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}users\+Handler()}}.

Gráfico de llamadas a esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c_icgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1AdminController_a3a9361b35478b054476a4119d92c953f}\label{classApp_1_1Controllers_1_1AdminController_a3a9361b35478b054476a4119d92c953f} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!usersHandler@{usersHandler}}
\index{usersHandler@{usersHandler}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{usersHandler()}{usersHandler()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::users\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Manejador para gestión de usuarios. 



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00073}{73}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00074\ \ \ \ \ \{}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$this-\/>session-\/>isAdmin())\ \{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /'});}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \$query\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ *\ FROM\ users\ ORDER\ BY\ id\ DESC"{}});}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \$users\ =\ \$query-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \$message\ =\ \textcolor{stringliteral}{''};}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (isset(\$\_GET[\textcolor{stringliteral}{'created'}])\ \&\&\ \$\_GET[\textcolor{stringliteral}{'created'}]\ ===\ \textcolor{stringliteral}{'true'})\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \$message\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Usuario\ creado\ correctamente'});}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (isset(\$\_GET[\textcolor{stringliteral}{'deleted'}])\ \&\&\ \$\_GET[\textcolor{stringliteral}{'deleted'}]\ ===\ \textcolor{stringliteral}{'true'})\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \$message\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Usuario\ eliminado\ correctamente'});}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'title'}\ =>\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1AdminController_a5f474ff29288092dce6b09cea6d6ed6c}{translate}}(\textcolor{stringliteral}{'Gestión\ de\ Usuarios'}),}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'users'}\ =>\ \$users,}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'message'}\ =>\ \$message}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00095\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{AdminController_8php_source_l00038}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}translate()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1AdminController_a3a9361b35478b054476a4119d92c953f_cgraph}
\end{center}
\end{figure}


\doxysubsection{Documentación de datos miembro}
\Hypertarget{classApp_1_1Controllers_1_1AdminController_a58fcd49448b51833b95e5458478cc78f}\label{classApp_1_1Controllers_1_1AdminController_a58fcd49448b51833b95e5458478cc78f} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!\$db@{\$db}}
\index{\$db@{\$db}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{\$db}{\$db}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::\$db\hspace{0.3cm}{\ttfamily [private]}}



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00011}{11}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.



Referenciado por \mbox{\hyperlink{AdminController_8php_source_l00020}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}\+\_\+\+\_\+construct()}}.

\Hypertarget{classApp_1_1Controllers_1_1AdminController_abaecdc9bc8e75441c253e5214190a97f}\label{classApp_1_1Controllers_1_1AdminController_abaecdc9bc8e75441c253e5214190a97f} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!\$fungiController@{\$fungiController}}
\index{\$fungiController@{\$fungiController}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{\$fungiController}{\$fungiController}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::\$fungi\+Controller\hspace{0.3cm}{\ttfamily [private]}}



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00014}{14}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.

\Hypertarget{classApp_1_1Controllers_1_1AdminController_ae1f931a6d5207c384593aa6e564f6d95}\label{classApp_1_1Controllers_1_1AdminController_ae1f931a6d5207c384593aa6e564f6d95} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!\$langController@{\$langController}}
\index{\$langController@{\$langController}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{\$langController}{\$langController}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::\$lang\+Controller\hspace{0.3cm}{\ttfamily [private]}}



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00015}{15}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.

\Hypertarget{classApp_1_1Controllers_1_1AdminController_afb44d06f307ac614afa172e41fed345d}\label{classApp_1_1Controllers_1_1AdminController_afb44d06f307ac614afa172e41fed345d} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!\$session@{\$session}}
\index{\$session@{\$session}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{\$session}{\$session}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::\$session\hspace{0.3cm}{\ttfamily [private]}}



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00012}{12}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.



Referenciado por \mbox{\hyperlink{AdminController_8php_source_l00020}{App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\textbackslash{}\+\_\+\+\_\+construct()}}.

\Hypertarget{classApp_1_1Controllers_1_1AdminController_a9a91cb5f6aab29cbe857940f72305f0c}\label{classApp_1_1Controllers_1_1AdminController_a9a91cb5f6aab29cbe857940f72305f0c} 
\index{App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}!\$userController@{\$userController}}
\index{\$userController@{\$userController}!App\textbackslash{}Controllers\textbackslash{}AdminController@{App\textbackslash{}Controllers\textbackslash{}AdminController}}
\doxysubsubsection{\texorpdfstring{\$userController}{\$userController}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Admin\+Controller\+::\$user\+Controller\hspace{0.3cm}{\ttfamily [private]}}



Definición en la línea \mbox{\hyperlink{AdminController_8php_source_l00013}{13}} del archivo \mbox{\hyperlink{AdminController_8php_source}{Admin\+Controller.\+php}}.



La documentación de esta clase está generada del siguiente archivo\+:\begin{DoxyCompactItemize}
\item 
src/controllers/\mbox{\hyperlink{AdminController_8php}{Admin\+Controller.\+php}}\end{DoxyCompactItemize}
