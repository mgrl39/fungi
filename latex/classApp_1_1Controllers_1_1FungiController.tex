\doxysection{Referencia de la clase App\textbackslash{}Controllers\textbackslash{}Fungi\+Controller}
\hypertarget{classApp_1_1Controllers_1_1FungiController}{}\label{classApp_1_1Controllers_1_1FungiController}\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}


Controlador para la gestión de hongos (fungi) en la aplicación.  




Diagrama de colaboración de App\textbackslash{}Controllers\textbackslash{}Fungi\+Controller\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=243pt]{classApp_1_1Controllers_1_1FungiController__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Métodos públicos}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_af7000ed08fe4bc6c08d0b40591e112b7}{\+\_\+\+\_\+construct}} (\$db)
\begin{DoxyCompactList}\small\item\em Constructor de la clase Fungi\+Controller. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a22e3774bb984c19ec5d27ef0b1a5c0a2}{add\+Fungi}} (\$data, \$user=null)
\begin{DoxyCompactList}\small\item\em Añade un nuevo hongo a la base de datos. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a9d16717512fc95fa89a23c45ad840b7b}{detail\+Fungus\+Handler}} (\$twig, \$db, \$session, \$params=\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Manejador para la ruta de detalles del hongo. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a0bb355407938be2032959dd234e0b13c}{get\+Fungus\+By\+Id}} (\$id)
\begin{DoxyCompactList}\small\item\em Obtiene un hongo por su ID. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_add0b456287a79c088c78a9fe8c469451}{get\+Fungus\+With\+Like\+Status}} (\$fungus, \$user\+Id)
\begin{DoxyCompactList}\small\item\em Añade el estado de like de un usuario a la información de un hongo. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a3a07c5dd018b701663a2a46a52f74a6d}{get\+Random\+Fungus}} ()
\begin{DoxyCompactList}\small\item\em Obtiene un hongo aleatorio de la base de datos. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a35fbbcc5cad471348611c0e1cfafebd7}{has\+User\+Liked\+Fungi}} (\$user\+Id, \$fungi\+Id)
\begin{DoxyCompactList}\small\item\em Verifica si un usuario ha dado like a un hongo. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a4e795756d06c8d0ff755c20645eddb12}{increment\+Fungi\+Views}} (\$fungi\+Id)
\begin{DoxyCompactList}\small\item\em Incrementa el contador de vistas de un hongo. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a61834711a6b3748eca87a0644c08babb}{like\+Fungi}} (\$user\+Id, \$fungi\+Id)
\begin{DoxyCompactList}\small\item\em Registra que un usuario ha dado like a un hongo. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_ade6fc0ad20f30ba8d2ba5efcf3d7064c}{random\+Fungus\+Handler}} (\$twig, \$db, \$session)
\begin{DoxyCompactList}\small\item\em Manejador para la ruta de hongo aleatorio. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a087b8275e77143716ac62ea228074a20}{unlike\+Fungi}} (\$user\+Id, \$fungi\+Id)
\begin{DoxyCompactList}\small\item\em Elimina el like de un usuario a un hongo. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_abd8eabf4c1f810b847481dc4af02691b}{update\+Fungi}} (\$fungi\+Id, \$data, \$user=null)
\begin{DoxyCompactList}\small\item\em Actualiza la información de un hongo. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Métodos privados}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a7f868fa3d67eefa14cd17d62e80b3d3d}{get\+Image\+Base\+Path}} (\$config\+Key)
\begin{DoxyCompactList}\small\item\em Obtiene la ruta base para las imágenes según la clave de configuración. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a69ba801a8491aa101cefc5928144e616}{load\+Fungus\+Images}} (\$fungus)
\begin{DoxyCompactList}\small\item\em Carga las imágenes relacionadas con un hongo desde la tabla de relaciones. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_af994c3d12f7062ddd44a40c3505bff3d}{update\+Fungi\+Likes}} (\$fungi\+Id, \$increment)
\begin{DoxyCompactList}\small\item\em Actualiza el contador de likes de un hongo. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Atributos privados}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_ab1b8e71c0976e182854ff195764611c6}{\$db}}
\end{DoxyCompactItemize}


\doxysubsection{Descripción detallada}
Controlador para la gestión de hongos (fungi) en la aplicación. 

Esta clase maneja las operaciones relacionadas con los hongos, incluyendo likes, vistas y consultas de información 

Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00013}{13}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.



\doxysubsection{Documentación de constructores y destructores}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_af7000ed08fe4bc6c08d0b40591e112b7}\label{classApp_1_1Controllers_1_1FungiController_af7000ed08fe4bc6c08d0b40591e112b7} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!\_\_construct@{\_\_construct}}
\index{\_\_construct@{\_\_construct}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{\_\_construct()}{\_\_construct()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::\+\_\+\+\_\+construct (\begin{DoxyParamCaption}\item[{}]{\$db }\end{DoxyParamCaption})}



Constructor de la clase Fungi\+Controller. 


\begin{DoxyParams}[1]{Parámetros}
object & {\em \$db} & Instancia del controlador de base de datos \\
\hline
\end{DoxyParams}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00023}{23}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00024\ \ \ \ \ \{}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \$this-\/>db\ =\ \mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_ab1b8e71c0976e182854ff195764611c6}{\$db}};}
\DoxyCodeLine{00026\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{FungiController_8php_source_l00016}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}\$db}}.



\doxysubsection{Documentación de funciones miembro}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_a22e3774bb984c19ec5d27ef0b1a5c0a2}\label{classApp_1_1Controllers_1_1FungiController_a22e3774bb984c19ec5d27ef0b1a5c0a2} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!addFungi@{addFungi}}
\index{addFungi@{addFungi}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{addFungi()}{addFungi()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::add\+Fungi (\begin{DoxyParamCaption}\item[{}]{\$data,  }\item[{}]{\$user = {\ttfamily null} }\end{DoxyParamCaption})}



Añade un nuevo hongo a la base de datos. 


\begin{DoxyParams}[1]{Parámetros}
array & {\em \$data} & Datos del nuevo hongo \\
\hline
array & {\em \$user} & Usuario que realiza la operación \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array Resultado de la operación 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00365}{365}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00366\ \ \ \ \ \{}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Verificar\ permisos\ de\ administrador\ si\ se\ proporciona\ usuario}}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$user\ \&\&\ (!isset(\$user[\textcolor{stringliteral}{'role'}])\ ||\ \$user[\textcolor{stringliteral}{'role'}]\ !==\ \textcolor{stringliteral}{'admin'}))\ \{}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ \textcolor{stringliteral}{'No\ tienes\ permisos\ para\ crear\ nuevos\ hongos'}}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Validar\ campos\ obligatorios\ (actualizados\ para\ coincidir\ con\ createFungi)}}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \$requiredFields\ =\ [\textcolor{stringliteral}{'name'},\ \textcolor{stringliteral}{'edibility'},\ \textcolor{stringliteral}{'habitat'}];}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\$requiredFields\ as\ \$field)\ \{}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!isset(\$data[\$field])\ ||\ empty(\$data[\$field]))\ \{}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ \textcolor{stringliteral}{"{}El\ campo\ '\{\$field\}'\ es\ obligatorio"{}}}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Preparar\ campos\ y\ valores\ para\ la\ inserción}}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \$allowedFields\ =\ [\textcolor{stringliteral}{'name'},\ \textcolor{stringliteral}{'edibility'},\ \textcolor{stringliteral}{'habitat'},\ \textcolor{stringliteral}{'observations'},\ \textcolor{stringliteral}{'common\_name'},\ \textcolor{stringliteral}{'synonym'},\ \textcolor{stringliteral}{'title'}];}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \$fields\ =\ [];}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \$values\ =\ [];}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \$placeholders\ =\ [];}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\$data\ as\ \$field\ =>\ \$value)\ \{}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (in\_array(\$field,\ \$allowedFields))\ \{}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$fields[]\ =\ \$field;}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$values[]\ =\ \$value;}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$placeholders[]\ =\ \textcolor{charliteral}{'?'};}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(\$fields))\ \{}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ \textcolor{stringliteral}{'No\ se\ proporcionaron\ campos\ válidos\ para\ crear\ el\ hongo'}}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ \$sql\ =\ \textcolor{stringliteral}{"{}INSERT\ INTO\ fungi\ ("{}}\ .\ implode(\textcolor{stringliteral}{',\ '},\ \$fields)\ .\ \textcolor{stringliteral}{"{})\ VALUES\ ("{}}\ .\ implode(\textcolor{stringliteral}{',\ '},\ \$placeholders)\ .\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ \$result\ =\ \$this-\/>db-\/>query(\$sql,\ \$values);}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$result)\ \{}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Obtener\ el\ ID\ del\ nuevo\ hongo\ insertado}}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$newFungiId\ =\ \$this-\/>db-\/>lastInsertId();}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Inicializar\ registro\ en\ fungi\_popularity}}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>db-\/>query(}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}INSERT\ INTO\ fungi\_popularity\ (fungi\_id,\ views,\ likes)\ VALUES\ (?,\ 0,\ 0)"{}},}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\$newFungiId]}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{true},}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'message'}\ =>\ \textcolor{stringliteral}{'Hongo\ creado\ correctamente'},}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'id'}\ =>\ \$newFungiId}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ \textcolor{stringliteral}{'Error\ al\ crear\ el\ hongo\ en\ la\ base\ de\ datos'}}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\(\backslash\)Exception\ \$e)\ \{}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ error\_log(\textcolor{stringliteral}{"{}Error\ creando\ hongo:\ "{}}\ .\ \$e-\/>getMessage());}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ \textcolor{stringliteral}{'Error\ interno\ del\ servidor:\ '}\ .\ \$e-\/>getMessage()}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00439\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_a9d16717512fc95fa89a23c45ad840b7b}\label{classApp_1_1Controllers_1_1FungiController_a9d16717512fc95fa89a23c45ad840b7b} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!detailFungusHandler@{detailFungusHandler}}
\index{detailFungusHandler@{detailFungusHandler}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{detailFungusHandler()}{detailFungusHandler()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::detail\+Fungus\+Handler (\begin{DoxyParamCaption}\item[{}]{\$twig,  }\item[{}]{\$db,  }\item[{}]{\$session,  }\item[{}]{\$params = {\ttfamily \mbox{[}\mbox{]}} }\end{DoxyParamCaption})}



Manejador para la ruta de detalles del hongo. 


\begin{DoxyParams}[1]{Parámetros}
object & {\em \$twig} & Instancia de Twig \\
\hline
object & {\em \$db} & Instancia de la base de datos \\
\hline
object & {\em \$session} & Controlador de sesión \\
\hline
array & {\em \$params} & Parámetros de la ruta \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array Datos para la plantilla 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00257}{257}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00258\ \ \ \ \ \{}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \$id\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_array(\$params)\ \&\&\ !empty(\$params))\ \{}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ \$id\ =\ \$params[0]\ ??\ \textcolor{keyword}{null};}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(\$id)\ \&\&\ isset(\$\_SERVER[\textcolor{stringliteral}{'REQUEST\_URI'}]))\ \{}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ preg\_match(\textcolor{stringliteral}{'\#\string^/fungi/(\(\backslash\)d+)\$\#'},\ \$\_SERVER[\textcolor{stringliteral}{'REQUEST\_URI'}],\ \$matches);}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \$id\ =\ \$matches[1]\ ??\ \textcolor{keyword}{null};}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ error\_log(\textcolor{stringliteral}{"{}FungiController::detailFungusHandler\ -\/\ ID:\ "{}}\ .\ (\$id\ ??\ \textcolor{stringliteral}{'no\ ID'}));\ \ \ \ \ \ \ }
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \$fungus\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a0bb355407938be2032959dd234e0b13c}{getFungusById}}(\$id);}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$fungus)\ \{}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /404'});}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00276\ \ \ \ \ \ \ }
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'title'}\ =>\ \$fungus[\textcolor{stringliteral}{'name'}]\ ??\ \_(\textcolor{stringliteral}{'Detalles\ del\ Hongo'}),}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'fungi'}\ =>\ \$fungus,}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'similar\_fungi'}\ =>\ \$similarFungi\ ??\ [],}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'is\_logged\_in'}\ =>\ \mbox{\hyperlink{routes_8php_abefb3c26429d514777313e9a63d7cbac}{\$session}}-\/>isLoggedIn()}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00283\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{routes_8php_source_l00093}{\$session}} y \mbox{\hyperlink{FungiController_8php_source_l00113}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}get\+Fungus\+By\+Id()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1FungiController_a9d16717512fc95fa89a23c45ad840b7b_cgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_a0bb355407938be2032959dd234e0b13c}\label{classApp_1_1Controllers_1_1FungiController_a0bb355407938be2032959dd234e0b13c} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!getFungusById@{getFungusById}}
\index{getFungusById@{getFungusById}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{getFungusById()}{getFungusById()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::get\+Fungus\+By\+Id (\begin{DoxyParamCaption}\item[{}]{\$id }\end{DoxyParamCaption})}



Obtiene un hongo por su ID. 


\begin{DoxyParams}[1]{Parámetros}
int & {\em \$id} & ID del hongo a buscar \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array\texorpdfstring{$\vert$}{|}null Datos del hongo o null si no se encuentra 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00113}{113}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00114\ \ \ \ \ \{}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \$result\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ *\ FROM\ fungi\ WHERE\ id\ =\ ?\ LIMIT\ 1"{}},\ [\$id]);}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$result\ instanceof\ \(\backslash\)PDOStatement)\ \$fungus\ =\ \$result-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC)\ ?:\ \textcolor{keyword}{null};}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_array(\$result)\ \&\&\ !empty(\$result)\ \&\&\ isset(\$result[0]))\ \$fungus\ =\ \$result[0];}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \$fungus\ =\ \$result;}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$fungus)\ \$fungus\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a69ba801a8491aa101cefc5928144e616}{loadFungusImages}}(\$fungus);}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$fungus;}
\DoxyCodeLine{00124\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{FungiController_8php_source_l00161}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}load\+Fungus\+Images()}}.



Referenciado por \mbox{\hyperlink{FungiController_8php_source_l00257}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}detail\+Fungus\+Handler()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1FungiController_a0bb355407938be2032959dd234e0b13c_cgraph}
\end{center}
\end{figure}
Gráfico de llamadas a esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1FungiController_a0bb355407938be2032959dd234e0b13c_icgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_add0b456287a79c088c78a9fe8c469451}\label{classApp_1_1Controllers_1_1FungiController_add0b456287a79c088c78a9fe8c469451} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!getFungusWithLikeStatus@{getFungusWithLikeStatus}}
\index{getFungusWithLikeStatus@{getFungusWithLikeStatus}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{getFungusWithLikeStatus()}{getFungusWithLikeStatus()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::get\+Fungus\+With\+Like\+Status (\begin{DoxyParamCaption}\item[{}]{\$fungus,  }\item[{}]{\$user\+Id }\end{DoxyParamCaption})}



Añade el estado de like de un usuario a la información de un hongo. 


\begin{DoxyParams}[1]{Parámetros}
array & {\em \$fungus} & Datos del hongo \\
\hline
int & {\em \$user\+Id} & ID del usuario\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array Datos del hongo con el estado de like añadido 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00101}{101}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00102\ \ \ \ \ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$fungus\ \&\&\ \$userId)\ \$fungus[\textcolor{stringliteral}{'is\_liked'}]\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a35fbbcc5cad471348611c0e1cfafebd7}{hasUserLikedFungi}}(\$userId,\ \$fungus[\textcolor{stringliteral}{'id'}]);}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$fungus;}
\DoxyCodeLine{00105\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{FungiController_8php_source_l00087}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}has\+User\+Liked\+Fungi()}}.



Referenciado por \mbox{\hyperlink{FungiController_8php_source_l00228}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}random\+Fungus\+Handler()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1FungiController_add0b456287a79c088c78a9fe8c469451_cgraph}
\end{center}
\end{figure}
Gráfico de llamadas a esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1FungiController_add0b456287a79c088c78a9fe8c469451_icgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_a7f868fa3d67eefa14cd17d62e80b3d3d}\label{classApp_1_1Controllers_1_1FungiController_a7f868fa3d67eefa14cd17d62e80b3d3d} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!getImageBasePath@{getImageBasePath}}
\index{getImageBasePath@{getImageBasePath}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{getImageBasePath()}{getImageBasePath()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::get\+Image\+Base\+Path (\begin{DoxyParamCaption}\item[{}]{\$config\+Key }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Obtiene la ruta base para las imágenes según la clave de configuración. 


\begin{DoxyParams}[1]{Parámetros}
string & {\em \$config\+Key} & Clave de configuración \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
string Ruta base para las imágenes 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00207}{207}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00208\ \ \ \ \ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Mapeo\ de\ claves\ de\ configuración\ a\ rutas\ base}}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \$pathMap\ =\ [}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'fungi\_upload\_path'}\ =>\ \textcolor{stringliteral}{'/assets/images'},}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'user\_upload\_path'}\ =>\ \textcolor{stringliteral}{'/assets/images/users'},}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'system\_images'}\ =>\ \textcolor{stringliteral}{'/assets/images/system'}}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Devolver\ la\ ruta\ correspondiente\ o\ una\ ruta\ predeterminada}}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$pathMap[\$configKey]\ ??\ \textcolor{stringliteral}{'/assets/images'};}
\DoxyCodeLine{00218\ \ \ \ \ \}}

\end{DoxyCode}


Referenciado por \mbox{\hyperlink{FungiController_8php_source_l00161}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}load\+Fungus\+Images()}}.

Gráfico de llamadas a esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1FungiController_a7f868fa3d67eefa14cd17d62e80b3d3d_icgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_a3a07c5dd018b701663a2a46a52f74a6d}\label{classApp_1_1Controllers_1_1FungiController_a3a07c5dd018b701663a2a46a52f74a6d} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!getRandomFungus@{getRandomFungus}}
\index{getRandomFungus@{getRandomFungus}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{getRandomFungus()}{getRandomFungus()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::get\+Random\+Fungus (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Obtiene un hongo aleatorio de la base de datos. 

\begin{DoxyReturn}{Devuelve}
array\texorpdfstring{$\vert$}{|}null Datos del hongo aleatorio o null si no se encuentra ninguno 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00131}{131}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00132\ \ \ \ \ \{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \$query\ =\ \textcolor{stringliteral}{"{}SELECT\ *\ FROM\ fungi\ ORDER\ BY\ RAND()\ LIMIT\ 1"{}};}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \$randomResult\ =\ \$this-\/>db-\/>query(\$query);}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Procesar\ el\ resultado\ según\ el\ tipo\ de\ retorno\ de\ la\ DB}}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$randomResult\ instanceof\ \(\backslash\)PDOStatement)\ \$fungus\ =\ \$randomResult-\/>fetch(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (is\_array(\$randomResult)\ \&\&\ !empty(\$randomResult))\ \$fungus\ =\ isset(\$randomResult[0])\ ?\ \$randomResult[0]\ :\ \$randomResult;}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \$fungus\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$fungus)\ \{}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Incrementar\ el\ contador\ de\ vistas\ para\ este\ hongo}}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a4e795756d06c8d0ff755c20645eddb12}{incrementFungiViews}}(\$fungus[\textcolor{stringliteral}{'id'}]);}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Cargar\ las\ imágenes\ relacionadas}}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \$fungus\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a69ba801a8491aa101cefc5928144e616}{loadFungusImages}}(\$fungus);}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Registrar\ para\ depuración}}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ error\_log(\textcolor{stringliteral}{"{}Cargando\ hongo\ aleatorio:\ "{}}\ .\ json\_encode(\$fungus[\textcolor{stringliteral}{'name'}]\ ??\ \textcolor{stringliteral}{'No\ encontrado'}));}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$fungus;}
\DoxyCodeLine{00153\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{FungiController_8php_source_l00074}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}increment\+Fungi\+Views()}} y \mbox{\hyperlink{FungiController_8php_source_l00161}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}load\+Fungus\+Images()}}.



Referenciado por \mbox{\hyperlink{FungiController_8php_source_l00228}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}random\+Fungus\+Handler()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1FungiController_a3a07c5dd018b701663a2a46a52f74a6d_cgraph}
\end{center}
\end{figure}
Gráfico de llamadas a esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1FungiController_a3a07c5dd018b701663a2a46a52f74a6d_icgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_a35fbbcc5cad471348611c0e1cfafebd7}\label{classApp_1_1Controllers_1_1FungiController_a35fbbcc5cad471348611c0e1cfafebd7} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!hasUserLikedFungi@{hasUserLikedFungi}}
\index{hasUserLikedFungi@{hasUserLikedFungi}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{hasUserLikedFungi()}{hasUserLikedFungi()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::has\+User\+Liked\+Fungi (\begin{DoxyParamCaption}\item[{}]{\$user\+Id,  }\item[{}]{\$fungi\+Id }\end{DoxyParamCaption})}



Verifica si un usuario ha dado like a un hongo. 


\begin{DoxyParams}[1]{Parámetros}
int & {\em \$user\+Id} & ID del usuario \\
\hline
int & {\em \$fungi\+Id} & ID del hongo\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
bool TRUE si el usuario ha dado like, FALSE en caso contrario 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00087}{87}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00088\ \ \ \ \ \{}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \$result\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ 1\ FROM\ user\_likes\ WHERE\ user\_id\ =\ ?\ AND\ fungi\_id\ =\ ?"{}},\ [\$userId,\ \$fungiId]);}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ !empty(\$result);}
\DoxyCodeLine{00091\ \ \ \ \ \}}

\end{DoxyCode}


Referenciado por \mbox{\hyperlink{FungiController_8php_source_l00101}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}get\+Fungus\+With\+Like\+Status()}}.

Gráfico de llamadas a esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1FungiController_a35fbbcc5cad471348611c0e1cfafebd7_icgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_a4e795756d06c8d0ff755c20645eddb12}\label{classApp_1_1Controllers_1_1FungiController_a4e795756d06c8d0ff755c20645eddb12} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!incrementFungiViews@{incrementFungiViews}}
\index{incrementFungiViews@{incrementFungiViews}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{incrementFungiViews()}{incrementFungiViews()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::increment\+Fungi\+Views (\begin{DoxyParamCaption}\item[{}]{\$fungi\+Id }\end{DoxyParamCaption})}



Incrementa el contador de vistas de un hongo. 


\begin{DoxyParams}[1]{Parámetros}
int & {\em \$fungi\+Id} & ID del hongo\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
mixed Resultado de la consulta a la base de datos 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00074}{74}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00075\ \ \ \ \ \{}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}INSERT\ INTO\ fungi\_popularity\ (fungi\_id,\ views,\ likes)\ VALUES\ (?,\ 1,\ 0)\ ON\ DUPLICATE\ KEY\ UPDATE\ views\ =\ views\ +\ 1"{}},\ [\$fungiId]);}
\DoxyCodeLine{00077\ \ \ \ \ \}}

\end{DoxyCode}


Referenciado por \mbox{\hyperlink{FungiController_8php_source_l00131}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}get\+Random\+Fungus()}}.

Gráfico de llamadas a esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1FungiController_a4e795756d06c8d0ff755c20645eddb12_icgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_a61834711a6b3748eca87a0644c08babb}\label{classApp_1_1Controllers_1_1FungiController_a61834711a6b3748eca87a0644c08babb} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!likeFungi@{likeFungi}}
\index{likeFungi@{likeFungi}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{likeFungi()}{likeFungi()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::like\+Fungi (\begin{DoxyParamCaption}\item[{}]{\$user\+Id,  }\item[{}]{\$fungi\+Id }\end{DoxyParamCaption})}



Registra que un usuario ha dado like a un hongo. 


\begin{DoxyParams}[1]{Parámetros}
int & {\em \$user\+Id} & ID del usuario \\
\hline
int & {\em \$fungi\+Id} & ID del hongo\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
mixed Resultado de la consulta a la base de datos 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00036}{36}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00037\ \ \ \ \ \{}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}INSERT\ INTO\ user\_likes\ (user\_id,\ fungi\_id)\ VALUES\ (?,\ ?)"{}},\ [\$userId,\ \$fungiId]);}
\DoxyCodeLine{00039\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_a69ba801a8491aa101cefc5928144e616}\label{classApp_1_1Controllers_1_1FungiController_a69ba801a8491aa101cefc5928144e616} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!loadFungusImages@{loadFungusImages}}
\index{loadFungusImages@{loadFungusImages}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{loadFungusImages()}{loadFungusImages()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::load\+Fungus\+Images (\begin{DoxyParamCaption}\item[{}]{\$fungus }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Carga las imágenes relacionadas con un hongo desde la tabla de relaciones. 


\begin{DoxyParams}[1]{Parámetros}
array & {\em \$fungus} & Datos del hongo \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array Datos del hongo con las URLs de imágenes añadidas 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00161}{161}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00162\ \ \ \ \ \{}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Consultar\ las\ imágenes\ relacionadas\ a\ través\ de\ la\ tabla\ de\ relación}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \$imagesResult\ =\ \$this-\/>db-\/>query(}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}SELECT\ i.filename,\ i.config\_key\ }}
\DoxyCodeLine{00166\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ FROM\ images\ i\ }}
\DoxyCodeLine{00167\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ JOIN\ fungi\_images\ fi\ ON\ i.id\ =\ fi.image\_id\ }}
\DoxyCodeLine{00168\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ \ WHERE\ fi.fungi\_id\ =\ ?"{}},}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ [\$fungus[\textcolor{stringliteral}{'id'}]]}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \$imageUrls\ =\ [];}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Si\ hay\ resultados,\ procesarlos}}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$imagesResult)\ \{}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$imagesResult\ instanceof\ \(\backslash\)PDOStatement)\ \$images\ =\ \$imagesResult-\/>fetchAll(\(\backslash\)PDO::FETCH\_ASSOC);}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \$images\ =\ is\_array(\$imagesResult)\ ?\ \$imagesResult\ :\ [\$imagesResult];}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\$images\ as\ \$image)\ \{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Construir\ la\ URL\ completa\ de\ la\ imagen\ basada\ en\ la\ config\_key}}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$basePath\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a7f868fa3d67eefa14cd17d62e80b3d3d}{getImageBasePath}}(\$image[\textcolor{stringliteral}{'config\_key'}]);}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$imageUrls[]\ =\ \$basePath\ .\ \textcolor{charliteral}{'/'}\ .\ \$image[\textcolor{stringliteral}{'filename'}];}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Si\ no\ hay\ imágenes,\ usar\ una\ por\ defecto}}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(\$imageUrls))\ \{}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \$imageUrls[]\ =\ \textcolor{stringliteral}{'/assets/images/placeholder.jpg'};}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ error\_log(\textcolor{stringliteral}{"{}No\ se\ encontraron\ imágenes\ para\ el\ hongo\ ID:\ "{}}\ .\ \$fungus[\textcolor{stringliteral}{'id'}]);}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Guardar\ las\ URLs\ como\ una\ cadena\ separada\ por\ comas\ (para\ mantener\ compatibilidad)}}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \$fungus[\textcolor{stringliteral}{'image\_urls'}]\ =\ implode(\textcolor{charliteral}{','},\ \$imageUrls);}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Para\ depuración}}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ error\_log(\textcolor{stringliteral}{"{}URLs\ de\ imágenes\ para\ hongo\ ID\ "{}}\ .\ \$fungus[\textcolor{stringliteral}{'id'}]\ .\ \textcolor{stringliteral}{"{}:\ "{}}\ .\ \$fungus[\textcolor{stringliteral}{'image\_urls'}]);}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$fungus;}
\DoxyCodeLine{00199\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{FungiController_8php_source_l00207}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}get\+Image\+Base\+Path()}}.



Referenciado por \mbox{\hyperlink{FungiController_8php_source_l00113}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}get\+Fungus\+By\+Id()}} y \mbox{\hyperlink{FungiController_8php_source_l00131}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}get\+Random\+Fungus()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1FungiController_a69ba801a8491aa101cefc5928144e616_cgraph}
\end{center}
\end{figure}
Gráfico de llamadas a esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1FungiController_a69ba801a8491aa101cefc5928144e616_icgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_ade6fc0ad20f30ba8d2ba5efcf3d7064c}\label{classApp_1_1Controllers_1_1FungiController_ade6fc0ad20f30ba8d2ba5efcf3d7064c} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!randomFungusHandler@{randomFungusHandler}}
\index{randomFungusHandler@{randomFungusHandler}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{randomFungusHandler()}{randomFungusHandler()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::random\+Fungus\+Handler (\begin{DoxyParamCaption}\item[{}]{\$twig,  }\item[{}]{\$db,  }\item[{}]{\$session }\end{DoxyParamCaption})}



Manejador para la ruta de hongo aleatorio. 


\begin{DoxyParams}[1]{Parámetros}
object & {\em \$twig} & Instancia de Twig \\
\hline
object & {\em \$db} & Instancia de la base de datos \\
\hline
object & {\em \$session} & Controlador de sesión \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array Datos para la plantilla 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00228}{228}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00229\ \ \ \ \ \{}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Obtener\ un\ hongo\ aleatorio}}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \$fungus\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_a3a07c5dd018b701663a2a46a52f74a6d}{getRandomFungus}}();}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$fungus)\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \ \ \ \ header(\textcolor{stringliteral}{'Location:\ /404'});}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \ \ exit;}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Añadir\ información\ de\ like\ si\ el\ usuario\ está\ logueado}}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{routes_8php_abefb3c26429d514777313e9a63d7cbac}{\$session}}-\/>isLoggedIn())\ \{}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \$fungus\ =\ \$this-\/>\mbox{\hyperlink{classApp_1_1Controllers_1_1FungiController_add0b456287a79c088c78a9fe8c469451}{getFungusWithLikeStatus}}(\$fungus,\ \$\_SESSION[\textcolor{stringliteral}{'user\_id'}]);}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'title'}\ =>\ \_(\textcolor{stringliteral}{'Hongo\ aleatorio'}),}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'fungi'}\ =>\ \$fungus}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00247\ \ \ \ \ \}}

\end{DoxyCode}


Hace referencia a \mbox{\hyperlink{routes_8php_source_l00093}{\$session}}, \mbox{\hyperlink{FungiController_8php_source_l00101}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}get\+Fungus\+With\+Like\+Status()}} y \mbox{\hyperlink{FungiController_8php_source_l00131}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}get\+Random\+Fungus()}}.

Gráfico de llamadas de esta función\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classApp_1_1Controllers_1_1FungiController_ade6fc0ad20f30ba8d2ba5efcf3d7064c_cgraph}
\end{center}
\end{figure}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_a087b8275e77143716ac62ea228074a20}\label{classApp_1_1Controllers_1_1FungiController_a087b8275e77143716ac62ea228074a20} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!unlikeFungi@{unlikeFungi}}
\index{unlikeFungi@{unlikeFungi}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{unlikeFungi()}{unlikeFungi()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::unlike\+Fungi (\begin{DoxyParamCaption}\item[{}]{\$user\+Id,  }\item[{}]{\$fungi\+Id }\end{DoxyParamCaption})}



Elimina el like de un usuario a un hongo. 


\begin{DoxyParams}[1]{Parámetros}
int & {\em \$user\+Id} & ID del usuario \\
\hline
int & {\em \$fungi\+Id} & ID del hongo\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
mixed Resultado de la consulta a la base de datos 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00049}{49}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00050\ \ \ \ \ \{}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}DELETE\ FROM\ user\_likes\ WHERE\ user\_id\ =\ ?\ AND\ fungi\_id\ =\ ?"{}},\ [\$userId,\ \$fungiId]);}
\DoxyCodeLine{00052\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_abd8eabf4c1f810b847481dc4af02691b}\label{classApp_1_1Controllers_1_1FungiController_abd8eabf4c1f810b847481dc4af02691b} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!updateFungi@{updateFungi}}
\index{updateFungi@{updateFungi}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{updateFungi()}{updateFungi()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::update\+Fungi (\begin{DoxyParamCaption}\item[{}]{\$fungi\+Id,  }\item[{}]{\$data,  }\item[{}]{\$user = {\ttfamily null} }\end{DoxyParamCaption})}



Actualiza la información de un hongo. 


\begin{DoxyParams}[1]{Parámetros}
int & {\em \$fungi\+Id} & ID del hongo a actualizar \\
\hline
array & {\em \$data} & Nuevos datos del hongo \\
\hline
array & {\em \$user} & Usuario que realiza la operación \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
array Resultado de la operación 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00293}{293}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00294\ \ \ \ \ \{}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Verificar\ permisos\ de\ administrador\ si\ se\ proporciona\ usuario}}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$user\ \&\&\ (!isset(\$user[\textcolor{stringliteral}{'role'}])\ ||\ \$user[\textcolor{stringliteral}{'role'}]\ !==\ \textcolor{stringliteral}{'admin'}))\ \{}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ \textcolor{stringliteral}{'No\ tienes\ permisos\ para\ realizar\ esta\ operación'}}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Verificar\ que\ el\ hongo\ exista}}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \$checkResult\ =\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}SELECT\ id\ FROM\ fungi\ WHERE\ id\ =\ ?"{}},\ [\$fungiId]);}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\$checkResult\ ||\ (\$checkResult\ instanceof\ \(\backslash\)PDOStatement\ \&\&\ !\$checkResult-\/>fetch()))\ \{}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ \textcolor{stringliteral}{'El\ hongo\ especificado\ no\ existe'}}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Construir\ consulta\ dinámica}}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \$fields\ =\ [];}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \$values\ =\ [];}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\$data\ as\ \$field\ =>\ \$value)\ \{}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Solo\ permitir\ campos\ válidos}}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (in\_array(\$field,\ [\textcolor{stringliteral}{'name'},\ \textcolor{stringliteral}{'edibility'},\ \textcolor{stringliteral}{'habitat'},\ \textcolor{stringliteral}{'observations'},\ \textcolor{stringliteral}{'common\_name'},\ \textcolor{stringliteral}{'synonym'},\ \textcolor{stringliteral}{'title'}]))\ \{}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$fields[]\ =\ \textcolor{stringliteral}{"{}\$field\ =\ ?"{}};}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \$values[]\ =\ \$value;}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (empty(\$fields))\ \{}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ \textcolor{stringliteral}{'No\ se\ proporcionaron\ campos\ válidos\ para\ actualizar'}}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Agregar\ ID\ para\ la\ cláusula\ WHERE}}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \$values[]\ =\ \$fungiId;}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \$sql\ =\ \textcolor{stringliteral}{"{}UPDATE\ fungi\ SET\ "{}}\ .\ implode(\textcolor{stringliteral}{',\ '},\ \$fields)\ .\ \textcolor{stringliteral}{"{}\ WHERE\ id\ =\ ?"{}};}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \$result\ =\ \$this-\/>db-\/>query(\$sql,\ \$values);}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$result)\ \{}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{true},}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'message'}\ =>\ \textcolor{stringliteral}{'Hongo\ actualizado\ correctamente'}}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ \textcolor{stringliteral}{'Error\ al\ actualizar\ el\ hongo\ en\ la\ base\ de\ datos'}}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\(\backslash\)Exception\ \$e)\ \{}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ error\_log(\textcolor{stringliteral}{"{}Error\ actualizando\ hongo:\ "{}}\ .\ \$e-\/>getMessage());}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'success'}\ =>\ \textcolor{keyword}{false},}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{'error'}\ =>\ \textcolor{stringliteral}{'Error\ interno\ del\ servidor:\ '}\ .\ \$e-\/>getMessage()}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ ];}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00356\ \ \ \ \ \}}

\end{DoxyCode}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_af994c3d12f7062ddd44a40c3505bff3d}\label{classApp_1_1Controllers_1_1FungiController_af994c3d12f7062ddd44a40c3505bff3d} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!updateFungiLikes@{updateFungiLikes}}
\index{updateFungiLikes@{updateFungiLikes}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{updateFungiLikes()}{updateFungiLikes()}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::update\+Fungi\+Likes (\begin{DoxyParamCaption}\item[{}]{\$fungi\+Id,  }\item[{}]{\$increment }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Actualiza el contador de likes de un hongo. 


\begin{DoxyParams}[1]{Parámetros}
int & {\em \$fungi\+Id} & ID del hongo \\
\hline
int & {\em \$increment} & Valor de incremento (positivo) o decremento (negativo)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Devuelve}
mixed Resultado de la consulta a la base de datos 
\end{DoxyReturn}


Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00062}{62}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00063\ \ \ \ \ \{}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \$this-\/>db-\/>query(\textcolor{stringliteral}{"{}UPDATE\ fungi\_popularity\ SET\ likes\ =\ likes\ +\ ?\ WHERE\ fungi\_id\ =\ ?"{}},\ [\$increment,\ \$fungiId]);}
\DoxyCodeLine{00065\ \ \ \ \ \}}

\end{DoxyCode}


\doxysubsection{Documentación de datos miembro}
\Hypertarget{classApp_1_1Controllers_1_1FungiController_ab1b8e71c0976e182854ff195764611c6}\label{classApp_1_1Controllers_1_1FungiController_ab1b8e71c0976e182854ff195764611c6} 
\index{App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}!\$db@{\$db}}
\index{\$db@{\$db}!App\textbackslash{}Controllers\textbackslash{}FungiController@{App\textbackslash{}Controllers\textbackslash{}FungiController}}
\doxysubsubsection{\texorpdfstring{\$db}{\$db}}
{\footnotesize\ttfamily App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\+::\$db\hspace{0.3cm}{\ttfamily [private]}}



Definición en la línea \mbox{\hyperlink{FungiController_8php_source_l00016}{16}} del archivo \mbox{\hyperlink{FungiController_8php_source}{Fungi\+Controller.\+php}}.



Referenciado por \mbox{\hyperlink{FungiController_8php_source_l00023}{App\textbackslash{}\+Controllers\textbackslash{}\+Fungi\+Controller\textbackslash{}\+\_\+\+\_\+construct()}}.



La documentación de esta clase está generada del siguiente archivo\+:\begin{DoxyCompactItemize}
\item 
src/controllers/\mbox{\hyperlink{FungiController_8php}{Fungi\+Controller.\+php}}\end{DoxyCompactItemize}
